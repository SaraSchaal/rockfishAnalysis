---
title: "Species_Respiration_Rate"
author: "Sara Michele Schaal"
date: "June 26, 2016"
output: pdf_document
---

Data import and manipulation 

```{r}

data <- read.csv("Fish_Measurement_Data_w_IDs_seq_4.csv")

data.2 <- subset(data, select = c("Date", "Species_Seq", "Weight_g", "Starting_DO_.ppm", "DO_30min_ppm", "Bucket"))

data.2.blk <- data.2[data.2$Date == 20150630,] 
data.2.cp <- data.2[data.2$Date == 20150714,]

data.3.blk <- na.omit(data.2.blk)
data.3.cp <- na.omit(data.2.cp)

data.3.blk$Res_Rate <- (data.3.blk$Starting_DO_.ppm-data.3.blk$DO_30min_ppm)/30
data.3.blk$Wei_Res_Rate <- data.3.blk$Res_Rate/data.3.blk$Weight_g


data.3.blk$exp_temp <- c(10.45769, 10.45769, 10.33846, 10.33846, 10.33846, 14.09038,
                       14.09038, 13.89808, 13.89808, 15.23462, 15.23462, 17.86923,
                       17.86923, 17.86923, 19.35962, 19.35962, 19.35962, 18.48462,
                       18.48462, 18.48462, 19.98462, 19.98462, 19.98462, 19.45192, 
                       19.45192, 19.45192, 20.18269, 20.18269, 20.18269, 20.71346, 
                       20.71346, 20.71346, 20.97308, 20.97308, 22.61731, 22.61731, 
                       22.35682, 22.35682)
                       
data.3.cp$Res_Rate  <- (data.3.cp$Starting_DO_.ppm-data.3.cp$DO_30min_ppm)/30
data.3.cp$Wei_Res_Rate <- data.3.cp$Res_Rate/data.3.cp$Weight_g

data.3.cp$exp_temp <- c(10.51111, 10.51111, 10.51111, 10.51111, 10.58704, 10.58704,
                        13.46111, 13.46111, 13.46111, 13.46111, 13.71667, 13.71667, 
                        13.71667, 15.10000, 15.10000, 15.10000, 17.15000, 17.15000,
                        17.15000, 17.97037, 17.97037, 17.97037, 17.97037, 19.22222,
                        19.22222, 19.22222, 18.90926, 18.90926, 18.90926, 19.98889,
                        19.98889, 19.91852, 19.91852, 19.91852, 21.03333, 21.03333, 
                        21.40741, 21.40741, 21.40741, 22.01296, 22.01296, 22.01296,
                        22.85417, 22.85417)                      

```

Subset based on species

```{r}

data.3.black  <- data.3.blk[data.3.blk$Species_Seq == "Black",]
data.3.yellowtail <- data.3.blk[data.3.blk$Species_Seq == "Yellowtail",]
data.3.by <- data.3.blk[data.3.blk$Species_Seq == "B/Y",]
data.3.bunknown <- data.3.blk[data.3.blk$Species_Seq == "",]
data.blkAyt <- data.3.blk[data.3.blk$Species_Seq == c("Black", "Yellowtail"),]

data.3.copper <- data.3.cp[data.3.cp$Species_Seq == "Copper",]
data.3.quillback <- data.3.cp[data.3.cp$Species_Seq == "Quillback",]
data.3.unknown <- data.3.cp[data.3.cp$Species_Seq == "",]




```

Black Rockfish Experiment: Plotting

```{r}
par(mfrow = c(2,1))
plot( data.3.black$exp_temp, data.3.black$Wei_Res_Rate, pch = 20, bty = "l",
     ylim = c(0, 0.055),
     main = "Black Rockfish", 
     ylab = "Respiration Rate (ppm O2 min-1)",
     xlab = "")

plot(data.3.yellowtail$exp_temp, data.3.yellowtail$Wei_Res_Rate, pch = 20, 
     ylim = c(0,0.055),
     col = "goldenrod", bty = "l",
     main = "Yellowtail Rockfish",
     ylab = "",
     xlab = "Experimental Temperature (Celcius)")

plot(data.3.by$exp_temp, data.3.by$Wei_Res_Rate, pch = 20, 
     col = "darkgrey", bty = "l",
     main = "B/Y sequencing Rockfish",
     ylab = "Respiration Rate (ppm O2 min-1)",
     xlab = "")

plot(data.3.bunknown$exp_temp, data.3.bunknown$Wei_Res_Rate, pch = 20, 
     col = "blue", bty = "l",
     main = "Not sequenced yet",
     ylab = "",
     xlab = "Experimental Temperature (Celcius)")

#Black and Yellowtail together

dev.off()
plot( data.3.black$exp_temp, data.3.black$Wei_Res_Rate, pch = 20, bty = "l",
     ylim = c(0, 0.055),
     main = "Black and Yellowtail Rockfish", 
     ylab = "Respiration Rate (ppm O2 min-1 g-1)",
     xlab = "Treatment Temperature (Celcius)")

points(data.3.yellowtail$exp_temp, data.3.yellowtail$Wei_Res_Rate, pch = 15, 
     col = "goldenrod")

points(data.3.by$exp_temp, data.3.by$Wei_Res_Rate, pch = 17, col = "darkred")

legend("topleft", legend = c("Black", "Yellowtail", "Hybrid"), pch = c(20, 15, 17), col = c("black", "goldenrod", "darkred"))

#Not sequenced
plot(data.3.bunknown$exp_temp, data.3.bunknown$Wei_Res_Rate, pch = 20, 
     ylim=c(0,0.055),
     col = "blue", bty = "l",
     main = "Not sequenced yet",
     ylab = "Respiration Rate (ppm O2 min-1 g-1)",
     xlab = "Experimental Temperature (Celcius)")




```

Analysis Black Rockfish Experiment

# Black and Yellowtail together to determine if there is a significant species interaction

```{r}

mod1.resp.blkAyt <- lm()
summary(mod1.resp.blkAyt)
drop1(mod1.resp.blkAyt)

```

```{r}

full.mod1.yellowtail <- lm(data.3.yellowtail$Wei_Res_Rate~data.3.yellowtail$exp_temp + I(data.3.yellowtail$exp_temp^2)) 
summary(full.mod1.yellowtail)
drop1(full.mod1.yellowtail)
#best model not significant

```

Plotting Copper Rockfish Experiment

```{r}

par(mfrow=c(3,1))
plot(data.3.copper$exp_temp, data.3.copper$Wei_Res_Rate, pch = 20,
     col = "orange", bty = "l", main = "Copper Rockfish",
     xlab = "", ylab = "")

plot(data.3.quillback$exp_temp, data.3.quillback$Wei_Res_Rate, pch = 20,
     col = "brown", bty = "l", main = "Quillback Rockfish",
     ylab = "Respiration Rate (ppm O2 min-1)", xlab = "")

plot(data.3.unknown$exp_temp, data.3.unknown$Wei_Res_Rate, pch = 20,
     col = "blue", bty = "l", main = "Not Sequenced Yet", 
     xlab = "Experimental Temperature (Celcius)", ylab = "")

```

Copper Analysis

```{r}

##Copper Analysis##

full.cp.mod1 <- lm(data.3.copper$Res_Rate~data.3.copper$exp_temp + I(data.3.copper$exp_temp^2) + I(data.3.copper$exp_temp^3))
summary(full.cp.mod1)
drop1(full.cp.mod1)
#best model

abline(full.cp.mod1)

curve(2.426e-01 - 4.724e-02*x + 2.973e-03*x^2 - 5.970e-05*x^3, add = T, col = "goldenrod", lwd = 1)
f  <- function(x) (2.426e-01 - 4.724e-02*x + 2.973e-03*x^2 - 5.970e-05*x^3)
optimize(f, c(10.22846, 22.61731), maximum = TRUE)
points(20.03268, 0.009400655, col = "goldenrod", pch = "|", lwd = 6)
text(13, 0.01, labels = expression(paste("T opt = 20.0",degree,"C")), col = "black")

##Quillback Analysis##

full.qb.mod1 <- lm(data.3.quillback$Res_Rate~data.3.quillback$exp_temp + I(data.3.quillback$exp_temp^2) + I(data.3.quillback$exp_temp^3))
summary(full.qb.mod1)
drop1(full.qb.mod1)
#best model no significance



```

```{r}

zeros.blk  <- read.csv("zeros_blk.csv", header = FALSE)
colnames(zeros.blk) <- c("Date", "Species_Seq", "Weight_g", "Starting_DO_.ppm", "DO_30min_ppm", "Bucket", "Res_Rate", "Wei_Res_Rate", "exp_temp")
black.zeros <- rbind(data.3.blk, zeros.blk)

zeros.cp  <- read.csv("zeros_cp.csv", header = FALSE)
colnames(zeros.cp) <- c("Date", "Species_Seq", "Weight_g", "Starting_DO_.ppm", "DO_30min_ppm", "Bucket", "Res_Rate", "Wei_Res_Rate", "exp_temp")
copper.zeros <- rbind(data.3.cp, zeros.cp)

black.zeros.2  <- black.zeros[black.zeros$Species_Seq == "Black",]
yellowtail.zeros <- black.zeros[black.zeros$Species_Seq == "Yellowtail",]
by.zeros <- black.zeros[black.zeros$Species_Seq == "B/Y",]
bunknown.zeros <- black.zeros[black.zeros$Species_Seq == "",]
data.zeros.blkAyt <- rbind(black.zeros.2, yellowtail.zeros)

copper.zeros.2 <- copper.zeros[copper.zeros$Species_Seq == "Copper",]
copper.zeros.2 <- copper.zeros.2[!(copper.zeros.2$Wei_Res_Rate < 0),]
quillback.zeros <- copper.zeros[copper.zeros$Species_Seq == "Quillback",]
unknown.zeros <- copper.zeros[copper.zeros$Species_Seq == "",]
data.zeros.cpAqb <- rbind(copper.zeros.2, quillback.zeros)


write.csv(black.zeros.2, "resp_species_black.csv")
write.csv(yellowtail.zeros, "resp_species_yellowtail.csv")
write.csv(copper.zeros.2, "resp_species_copper.csv")
write.csv(quillback.zeros, "resp_species_quillback.csv")


```

Plotting with zeros data

Black Rockfish Experiment


```{r}
dev.off()
plot(black.zeros.2$exp_temp, black.zeros.2$Wei_Res_Rate, pch = 20, bty = "l",
     ylim = c(0, 0.055), lwd = 4,
     main = "Black Rockfish Experiment", 
     ylab = "Respiration Rate (ppm O2 min-1 g-1)",
     xlab = expression(paste("Temperature (",degree,"C)")))

points(yellowtail.zeros$exp_temp, yellowtail.zeros$Wei_Res_Rate, pch = 15, 
       col = "goldenrod", lwd = 4)

#points(by.zeros$exp_temp, by.zeros$Wei_Res_Rate, pch = 17, 
#       col = "darkred")

legend("topleft", legend = c("Black", "Yellowtail"), pch = c(20, 15), col = c("black", "goldenrod"))

plot(bunknown.zeros$exp_temp, bunknown.zeros$Wei_Res_Rate, pch = 20, 
     ylim=c(0,0.055),
     col = "blue", bty = "l",
     main = "Not sequenced yet",
     ylab = "Respiration Rate (ppm O2 min-1 g-1)",
     xlab = "Experimental Temperature (Celcius)")

```

# Analyze Black and Yellowtail Rockfish together to determine if there is a significant species interaction

```{r}

mod1.resp.blkAyt <- lm(data.zeros.blkAyt$Wei_Res_Rate~data.zeros.blkAyt$exp_temp*data.zeros.blkAyt$Species_Seq + I(data.zeros.blkAyt$exp_temp^2))
summary(mod1.resp.blkAyt)
drop1(mod1.resp.blkAyt)
# Significant Species Interaction ANALYZE SEPARATELY

```

# Analyzing Black and Yellowtail Rockfish separately 

```{r}

mod1.zeros.blk <- lm(black.zeros.2$Wei_Res_Rate~black.zeros.2$exp_temp + I(black.zeros.2$exp_temp^2))
summary(mod1.zeros.blk)
drop1(mod1.zeros.blk)

curve

mod2.zeros.blk <- lm(black.zeros.2$Wei_Res_Rate~black.zeros.2$exp_temp)
summary(mod2.zeros.blk)


curve(-0.0297770 + 0.0062169 *x -0.0001842*x^2, add = T, col = "black", lwd = 1)

mod1.zeros.yt <- lm(yellowtail.zeros$Wei_Res_Rate~yellowtail.zeros$exp_temp + I(yellowtail.zeros$exp_temp^2))
summary(mod1.zeros.yt)
drop1(mod1.zeros.yt)


```

Copper Rockfish Experiment with zeros

# Analyze together to determine if there is a significant species interaction

```{r}

mod1.resp.cpAqb <- lm(data.zeros.cpAqb$Wei_Res_Rate~data.zeros.cpAqb$exp_temp*data.zeros.cpAqb$Species_Seq + I(data.zeros.cpAqb$exp_temp^2))
summary(mod1.resp.cpAqb)
drop1(mod1.resp.cpAqb)
# Significant Species Interaction analyze separately

```

# Copper and Quillback Separate

```{r}

plot(copper.zeros.2$exp_temp, copper.zeros.2$Wei_Res_Rate, pch = 20,
     col = "orange", bty = "l", main = "Copper Rockfish", lwd = 4,
     ylab = "Respiration Rate (ppm O2 min-1 g-1)", 
     xlab = expression(paste("Temperature (",degree,"C)")))

points(quillback.zeros$exp_temp, quillback.zeros$Wei_Res_Rate, pch = 20,
     col = "brown", lwd = 4)

plot(data.3.unknown$exp_temp, data.3.unknown$Wei_Res_Rate, pch = 20,
     col = "blue", bty = "l", main = "Not Sequenced Yet", 
     xlab = "Experimental Temperature (Celcius)", 
     ylab = "Respiration Rate (ppm O2 min-1 g-1)")


```

```{r}

mod1.zeros.cp <- lm(copper.zeros.2$Wei_Res_Rate~copper.zeros.2$exp_temp + I(copper.zeros.2$exp_temp^2) + I(copper.zeros.2$exp_temp^3))
summary(mod1.zeros.cp)
drop1(mod1.zeros.cp)
#best model all significant

mod2.zeros.cp <- lm(copper.zeros.2$Wei_Res_Rate~copper.zeros.2$exp_temp + I(copper.zeros.2$exp_temp^2))
summary(mod2.zeros.cp)
drop1(mod2.zeros.cp)

plot(copper.zeros.2$exp_temp, copper.zeros.2$Wei_Res_Rate, pch = 20,
     col = "orange", bty = "l", main = "Copper Rockfish",
     ylab = "Respiration Rate (ppm O2 min-1 g-1)", 
     xlab = "Experimental Temperature (Celcius)")

curve(-0.0146099 +  0.0039313*x - 0.0001123*x^2 , add = T, col = "goldenrod", lwd = 1)

# f  <- function(x) (0.5732 - 0.1096*x + 0.006933*x^2 - 0.0001412*x^3)
# optimize(f, c(10.22846, 22.61731), maximum = TRUE)
# points(19.39, 0.02530859, col = "black", pch = "|", lwd = 6)
# text(13, 0.04, labels = expression(paste("T opt = 19.4",degree,"C")), col = "black")

points(quillback.zeros$exp_temp, quillback.zeros$Wei_Res_Rate, pch = 20,
     col = "brown", bty = "l", main = "Quillback Rockfish",
     ylab = "Respiration Rate (ppm O2 min-1 g-1)", 
     xlab = "Experimental Temperature (Celcius)", ylim = c(0, 0.07))


mod1.quillback <- lm(quillback.zeros$Wei_Res_Rate~quillback.zeros$exp_temp + I(quillback.zeros$exp_temp^2) + I(quillback.zeros$exp_temp^3))
summary(mod1.quillback)
drop1(mod1.quillback)
#best model not significant

mod2.quillback <- lm(quillback.zeros$Wei_Res_Rate~quillback.zeros$exp_temp)
summary(mod2.quillback)

abline(mod2.quillback)
```

