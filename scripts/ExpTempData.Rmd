---
title: "Rockfish Temperature Data"
author: "Sara Michele Schaal"
date: "1/20/2019"
output: html_document
---

```{r}

# Install packages
    if(!("plyr" %in% installed.packages())){
      install.packages("plyr")
    }
    if(!("dplyr" %in% installed.packages())){
      install.packages("dplyr")
    }
    if(!("reshape2" %in% installed.packages())){
      install.packages("reshape2")
    }
    if(!("AICcmodavg" %in% installed.packages())){
      install.packages("AICcmodavg")
    }
    if(!("ggplot2" %in% installed.packages())){
      install.packages("ggplot2")
    }

    library(plyr)
    library(dplyr)
    library(reshape2)
    library(AICcmodavg)
    library(ggplot2)

```

```{r}
## Black Rockfish ##

    # Load Data Frames
      temp.data <- read.csv("data/Temp_Data_Black.csv")
      head(temp.data)
      temp.data2 <- temp.data[, -(14:15)]
      
    # average temperatures measured by GAMMA and pH Meter and put values in new column
      temp.data$meanTemp <- rowMeans(subset(temp.data, select = c(Gamma, pH_Meter)), na.rm = TRUE)

    # Plot
      df.expBuckets <- NULL
     df.expBuckets <-  temp.data[temp.data$Bucket_ID != "BIG 1" | temp.data$Bucket_ID != "BIG 2" | temp.data$Bucket_ID != "BIG 3" | temp.data$Bucket_ID != "COLD" | temp.data$Bucket_ID != "HOT" | temp.data$Bucket_ID != "SW1" | temp.data$Bucket_ID != "SW2", ]
      
      df.holdBuckets <- temp.data[temp.data$Bucket_ID == "BIG 1" | temp.data$Bucket_ID == "BIG 2" | temp.data$Bucket_ID == "BIG 3",]
      
      
      ggplot(df.expBuckets,aes(x=Temperature_Treatment,y=meanTemp,group=Bucket_ID))+geom_boxplot()
 
    # Turn data frame into tlb_df object so that text wraps so they don't fill screen
      temp.df <- tbl_df(temp.data2)
      levels(temp.df$Bucket_ID)
      
    # get mean and standard deviation of bucket temps
      summary.data <- select(temp.df, Bucket_ID, Temperature_Treatment, meanTemp)
      melted.temp.data <- melt(summary.data, id.vars = c("Bucket_ID", "Temperature_Treatment"), 
                              na.rm = TRUE)
      summary.stats.black <- ddply(melted.temp.data, c("Bucket_ID", "Temperature_Treatment"), 
                                  summarise, mean = mean(value), sd = sd(value))

      treatment.buckets.summ.blk <- summary.stats.black[c(1:5, 7, 9, 10:16), ]
      all.treatment.buckets.blk <- summary.stats.black[c(1:16),]
      write.csv(all.treatment.buckets.blk, "data/black_exp_temps.csv", row.names = FALSE)
      
      
  ## Copper Rockfish ##

    # Load Data
      temp.data.cp <- read.csv("data/Temp_Data_Copper.csv")
      head(temp.data.cp)

    # Turn data fram into a tbl_df to wrap text and calculate Mean of Gamma and pH Meter temps
      temp.df.cp <- tbl_df(temp.data.cp)
      temp.df.cp$mean <- rowMeans(subset(temp.df.cp, select = c(Gamma, pH_Meter)), 
                                  na.rm = TRUE)

    # Calculate summary statistics
      summary.data.cp <- select(temp.df.cp, Bucket_ID, Temperature_Treatment, mean)
      melted.temp.data.cp <- melt(summary.data.cp, id.vars = c("Bucket_ID", "Temperature_Treatment"), 
                                  na.rm = TRUE)
      summary.stats.copper <- ddply(melted.temp.data.cp, c("Bucket_ID","Temperature_Treatment"), 
                                    summarise, mean = mean(value), sd = sd(value))
  
    # Separate out just treatment values
      treatment.buckets.summ.cp <- summary.stats.copper[c(1:6, 9:16), ]
      all.treatment.buckets.cp <- summary.stats.copper[c(1:16),]
      write.csv(all.treatment.buckets.cp, "data/copper_exp_temps.csv", row.names = FALSE)

```