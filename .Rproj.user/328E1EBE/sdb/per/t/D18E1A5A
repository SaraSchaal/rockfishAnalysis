{
    "collab_server" : "",
    "contents" : "# Analysis of Rockfish Phenotype Data\n# SM Schaal\n# September 25, 2015\n\n#### Temperature Data ####\n  # set working directory\n    setwd(\"~/Documents/Northeastern/Lotterhos_Lab/Field Work/2015/TPC_Experiment/Analysis\")\n\n  # Install packages\n    library(\"plyr\")\n    library(\"dplyr\")\n    library(\"reshape2\")\n    library(\"ggplot2\")\n    library(\"AICcmodavg\")\n\n  ## Black Rockfish ##\n\n    # Load Data Frames\n      temp.data <- read.csv(\"Temp_Data_Black.csv\")\n      head(temp.data)\n      temp.data2 <- temp.data[, -(14:15)]\n\n    # Turn data frame into tlb_df object so that text wraps so they don't fill screen\n      temp.df <- tbl_df(temp.data2)\n      levels(temp.df$Bucket_ID)\n\n    # average temperatures measured by GAMMA and pH Meter and put values in new column\n      temp.df$mean <- rowMeans(subset(temp.df, select = c(Gamma, pH_Meter)), na.rm = TRUE)\n\n    # get mean and standard deviation of bucket temps\n      summary.data <- select(temp.df, Bucket_ID, Temperature_Treatment, mean)\n      melted.temp.data <- melt(summary.data, id.vars = c(\"Bucket_ID\", \"Temperature_Treatment\"), \n                              na.rm = TRUE)\n      summary.stats.black <- ddply(melted.temp.data, c(\"Bucket_ID\", \"Temperature_Treatment\"), \n                                  summarise, mean = mean(value), sd = sd(value))\n\n      treatment.buckets.summ.blk <- summary.stats.black[c(1:5, 7, 9, 10:16), ]\n\n  ## Copper Rockfish ##\n\n    # Load Data\n      temp.data.cp <- read.csv(\"Temp_Data_Copper.csv\")\n      head(temp.data.cp)\n\n    # Turn data fram into a tbl_df to wrap text and calculate Mean of Gamma and pH Meter temps\n      temp.df.cp <- tbl_df(temp.data.cp)\n      temp.df.cp$mean <- rowMeans(subset(temp.df.cp, select = c(Gamma, pH_Meter)), \n                                  na.rm = TRUE)\n\n    # Calculate summary statistics\n      summary.data.cp <- select(temp.df.cp, Bucket_ID, Temperature_Treatment, mean)\n      melted.temp.data.cp <- melt(summary.data.cp, id.vars = c(\"Bucket_ID\", \"Temperature_Treatment\"), \n                                  na.rm = TRUE)\n      summary.stats.copper <- ddply(melted.temp.data.cp, c(\"Bucket_ID\",\"Temperature_Treatment\"), \n                                    summarise, mean = mean(value), sd = sd(value))\n  \n    # Separate out just treatment values\n      treatment.buckets.summ.cp <- summary.stats.copper[c(1:6, 9:16), ]\n    \n#### Growth Data ####\n  \n  # Load Data Frame\n    df.blacktemp <- read.csv(\"Temp_Data_Black.csv\")\n    df.coppertemp <- read.csv(\"Temp_Data_Copper.csv\")\n    df.growth <- read.csv(\"Fish_Measurement_Data_w_IDs_seq_4.csv\")\n\n  # Subset Dataframe to Include only Those Necessary for Analysis\n    df.subgrowth  <- subset(df.growth, select = c(\"Date\", \"Species\", \"Length_mm\", \"Weight_g\",\n                                                  \"Experimental_Treatment_C\", \"Bucket\"))\n\n  # Remove columns with any NAs\n    df.completegrowth <- na.omit(df.subgrowth)\n\n\n#### Analysis for Black Rockfish Experiment ####\n\n  ## Length Data Manipulation ##\n\n    # Get measurement data from first day and last day of experiment\n      correct.day.blk <- which(df.completegrowth$Date==20150620)\n      start.length.blk <- tapply(df.completegrowth$Length_mm[correct.day.blk], df.completegrowth$Bucket[correct.day.blk], mean)\n      last.day.blk <- which(df.completegrowth$Date==20150703)\n      end.length.blk <- tapply(df.completegrowth$Length_mm[last.day.blk], df.completegrowth$Bucket[last.day.blk], mean, na.rm=TRUE)\n\n    # Create data frames for starting data and ending data and merge them\n      df.start.length.blk <- data.frame(bucket=names(start.length.blk), start.length.blk)\n      df.end.length.blk <- data.frame(bucket=names(end.length.blk), end.length.blk)\n      df.2.length.blk <- merge(df.start.length.blk, df.end.length.blk)\n\n    # Get temperature data for each bucket\n      df.temp.blk <- tapply(df.completegrowth$Experimental_Treatment_C, df.completegrowth$Bucket, mean)\n\n    # Put temperature information into a dataframe and merge with measurement data\n      df.temp2.blk <- data.frame(bucket=names(df.temp.blk), df.temp.blk)\n      df.3.length.blk <- merge(df.temp2.blk, df.2.length.blk)\n\n    # Create data frame of length data to merge with temp data\n      df.3.length.blk$length.change <- (df.3.length.blk$end.length.blk-df.3.length.blk$start.length.blk)\n      blk.growth.data <- select(df.3.length.blk, bucket, length.change)\n\n  ## Weight Data Manipulation ##\n\n    # Get weight data from first day and last day of experiment\n      start.weight.blk <- tapply(df.completegrowth$Weight_g[correct.day.blk], df.completegrowth$Bucket[correct.day.blk], mean)\n      end.weight.blk <- tapply(df.completegrowth$Weight_g[last.day.blk], df.completegrowth$Bucket[last.day.blk], mean, na.rm=TRUE)\n\n    # Create data frames for starting data and ending data and merge them\n      df.start.weight.blk <- data.frame(bucket=names(start.weight.blk), start.weight.blk)\n      df.end.weight.blk <- data.frame(bucket=names(end.weight.blk), end.weight.blk)\n      df.2.weight.blk <- merge(df.start.weight.blk, df.end.weight.blk)\n\n    # Put temperature information into a dataframe and merge with measurement data\n      df.3.weight.blk <- merge(df.temp2.blk, df.2.weight.blk)\n\n    # Create data frame of growth data to merge with temp and length\n      df.3.weight.blk$weight.change <- (df.3.weight.blk$end.weight.blk-df.3.weight.blk$start.weight.blk)    \n      blk.weight <- select(df.3.weight.blk, weight.change)\n      blk.growth.data2 <- cbind(blk.growth.data, blk.weight)\n    \n    # cbind actual bucket temperatures from averages\n      blk.growth.data3 <- cbind(treatment.buckets.summ.blk$mean, \n                                treatment.buckets.summ.blk$sd, \n                                df.3.weight.blk$start.weight.blk, \n                                df.3.weight.blk$end.weight.blk, blk.growth.data2)\n      names(blk.growth.data3)[1] <- \"mean\"\n      names(blk.growth.data3)[2] <- \"sd\"\n      names(blk.growth.data3)[3] <- \"start.weight\"\n      names(blk.growth.data3)[4] <- \"end.weight\"\n  \n    ## Condition Factor Before and After ##\n      blk.growth.data3$CF.start <- ((df.3.weight.blk$start.weight.blk)/(df.3.length.blk$start.length.blk)^3)*100\n      blk.growth.data3$CF.end <- ((df.3.weight.blk$end.weight.blk)/(df.3.length.blk$end.length.blk)^3)*100\n\n    # Change in CF\n      blk.growth.data3$CF.change <- (blk.growth.data3$CF.end-blk.growth.data3$CF.start)\n  \n## Plots ##\n\n      # Make sure data transferred correctly and plots are same as before\n        plot(blk.growth.data3$mean, blk.growth.data3$weight.change, pch = 20,\n             xlab = \"Temperature Treatment (Celcius)\", ylab = \"Mean Weight Change (g)\", \n             main = \"Black Rockfish Growth Rate - Weight \", bty = \"l\")\n  \n        plot(blk.growth.data3$mean, blk.growth.data3$length.change, pch = 20,\n             xlab = \"Temperature Treatment (Celcius)\", ylab = \"Mean Length Change (mm)\", \n             main = \"Black Rockfish Growth Rate - Length\", bty = \"l\")\n        \n      # % Weight gain calculation\n        blk.growth.data3$weight.change.percent <- ((blk.growth.data3$weight.change/df.3.weight.blk$start.weight.blk)*100)\n       \n\n#### Analysis for Copper Rockfish ####\n\n  ## Length Data Manipulation ##\n\n    # Get measurement data from first day and last day of experiment\n      correct.day.cp <- which(df.completegrowth$Date==20150704)\n      start.length.cp <- tapply(df.completegrowth$Length_mm[correct.day.cp], df.completegrowth$Bucket[correct.day.cp], mean)\n      last.day.cp <- which(df.completegrowth$Date==20150718)\n      end.length.cp <- tapply(df.completegrowth$Length_mm[last.day.cp], df.completegrowth$Bucket[last.day.cp], mean, na.rm=TRUE)\n\n    # Create data frames for starting data and ending data and merge them\n      df.start.length.cp <- data.frame(bucket=names(start.length.cp), start.length.cp)\n      df.end.length.cp <- data.frame(bucket=names(end.length.cp), end.length.cp)\n      df.2.length.cp <- merge(df.start.length.cp, df.end.length.cp)\n\n    # Get temperature data for each bucket\n      df.temp.cp <- tapply(df.completegrowth$Experimental_Treatment_C, df.completegrowth$Bucket, mean)\n\n    # Put temperature information into a dataframe and merge with measurement data\n      df.temp2.cp<- data.frame(bucket=names(df.temp.cp), df.temp.cp)\n      df.3.length.cp <- merge(df.temp2.cp, df.2.length.cp)\n\n    # Create data frame of length data to merge with temp data\n      df.3.length.cp$length.change <- (df.3.length.cp$end.length.cp-df.3.length.cp$start.length.cp)\n      cp.growth.data <- select(df.3.length.cp, bucket, length.change)\n\n  ## Weight Data Manipulation ##\n  \n    # Get weight data from first day and last day of experiment\n      start.weight.cp <- tapply(df.completegrowth$Weight_g[correct.day.cp], df.completegrowth$Bucket[correct.day.cp], mean)\n      end.weight.cp <- tapply(df.completegrowth$Weight_g[last.day.cp], df.completegrowth$Bucket[last.day.cp], mean, na.rm=TRUE)\n\n    # Create data frames for starting data and ending data and merge them\n      df.start.weight.cp <- data.frame(bucket=names(start.weight.cp), start.weight.cp)\n      df.end.weight.cp <- data.frame(bucket=names(end.weight.cp), end.weight.cp)\n      df.2.weight.cp <- merge(df.start.weight.cp, df.end.weight.cp)\n   \n    # Put temperature information into a dataframe and merge with measurement data\n      df.3.weight.cp <- merge(df.temp2.cp, df.2.weight.cp)\n\n    # Create data frame of growth data to merge with temp and length\n      df.3.weight.cp$weight.change <- (df.3.weight.cp$end.weight.cp-df.3.weight.cp$start.weight.cp)    \n      cp.weight <- select(df.3.weight.cp, weight.change)\n      cp.growth.data2 <- cbind(cp.growth.data, cp.weight)\n\n    # cbind actual bucket temperatures from averages\n      cp.growth.data3 <- cbind(treatment.buckets.summ.cp$mean, treatment.buckets.summ.cp$sd, \n                               df.3.weight.cp$start.weight.cp, df.3.weight.cp$end.weight.cp, cp.growth.data2)\n      names(cp.growth.data3)[1] <- \"mean\"\n      names(cp.growth.data3)[2] <- \"sd\"\n      names(cp.growth.data3)[3] <- \"start.weight\"\n      names(cp.growth.data3)[4] <- \"end.weight\"\n\n  ## Condition Factor Before and After ##\n      \n    # start and end condition factor calculation\n      cp.growth.data3$CF.start <- ((df.3.weight.cp$start.weight.cp)/(df.3.length.cp$start.length.cp)^3)*100\n      cp.growth.data3$CF.end <- ((df.3.weight.cp$end.weight.cp)/(df.3.length.cp$end.length.cp)^3)*100\n\n    # Change in CF\n      cp.growth.data3$CF.change <- (cp.growth.data3$CF.end-cp.growth.data3$CF.start)\n\n  ## Plots ##\n\n    # Make sure data transferred correctly and plots are same as before\n      plot(cp.growth.data3$mean, cp.growth.data3$weight.change, pch = 20, \n           xlab = \"Temperature Treatment (Celcius)\", ylab = \"Mean Weight Change (g)\", \n           main = \"Copper Rockfish Growth Rate - Weight\", bty = \"l\")\n  \n      plot(cp.growth.data3$mean, cp.growth.data3$length.change, pch = 20, \n           xlab = \"Temperature Treatment (Celcius)\", ylab = \"Mean Length Change (mm)\", \n           main = \"Copper Rockfish Growth Rate - Length\", bty = \"l\")\n\n    # Condition factor calculation\n      cp.growth.data3$condition.factor <- ((cp.growth.data3$weight.change/(cp.growth.data3$length.change)^3)*100)\n\n    # Plot condition factor\n      plot(cp.growth.data3$mean, cp.growth.data3$CF.change, pch = 18,\n           bty = \"l\", main = \"Condition Factor - Copper\",\n           ylab = \"Condition Factor\", \n           xlab = \"Temperature Treatment (Celcius)\", col = \"blue\")\n           # ylim =c(-0.00025, 0.00005)\n  \n      ggplot(blk.growth.data3, aes(x=mean, y=CF.change)) + labs(x = \"Temperature (Celcius)\", \n            y = \"Condition Factor\") + ggtitle(\"Condition Factor - Black Rockfish\") + geom_point() + geom_smooth()\n\n      plot(blk.growth.data3$mean, blk.growth.data3$CF.change, pch = 20,\n          bty = \"l\", main = \"Condition Factor - Black\",\n          ylab = \"Condition Factor\", \n          xlab = \"Temperature Treatment (Celcius)\")\n\n      ggplot(cp.growth.data3, aes(x=mean, y=CF.change)) + labs(x = \"Temperature (Celcius)\", \n             y = \"Condition Factor\") + ggtitle(\"Condition Factor - Copper Rockfish\") + geom_point() + geom_smooth()\n    \n# Full model with squared term and initial weight as a predictor\n\n    full.blk.CF <- lm(blk.growth.data3$CF.change~blk.growth.data3$mean + I(blk.growth.data3$mean^2) + blk.growth.data3$start.weight)\n    full.cp.CF <- lm(cp.growth.data3$CF.change~cp.growth.data3$mean + I(cp.growth.data3$mean^2) + cp.growth.data3$start.weight)\n    summary(full.blk.CF)\n    summary(full.cp.CF)\n\n# dropping start.weight \n\n    drop.stweight.blk.CF <- lm(blk.growth.data3$CF.change~blk.growth.data3$mean + I(blk.growth.data3$mean^2))\n    drop.stweight.cp.CF <- lm(cp.growth.data3$CF.change~cp.growth.data3$mean + I(cp.growth.data3$mean^2))\n    summary(drop.stweight.blk.CF)    \n    summary(drop.stweight.cp.CF)\n\n# dropping linear term\n\n    drop.linear.blk.CF <- lm(blk.growth.data3$CF.change~I(blk.growth.data3$mean^2) + blk.growth.data3$start.weight)  \n    drop.linear.cp.CF <- lm(cp.growth.data3$CF.change~I(cp.growth.data3$mean^2) + cp.growth.data3$start.weight)\n    summary(drop.linear.blk.CF)\n    summary(drop.linear.cp.CF)\n\n# dropping both linear and start.weight\n\n    drop.lin.stwe.blk.CF  <- lm(blk.growth.data3$CF.change~I(blk.growth.data3$mean^2))\n    drop.lin.stwe.cp.CF <- lm(cp.growth.data3$CF.change~I(cp.growth.data3$mean^2))\n    summary(drop.lin.stwe.blk.CF)\n    summary(drop.lin.stwe.cp.CF)\n\n#comparing models\n\n  #black\n    anova(full.blk.CF, drop.stweight.blk.CF)\n    anova(full.blk.CF, drop.linear.blk.CF)\n    \n    AICc(full.blk.CF)\n    AICc(drop.stweight.blk.CF)  \n    AICc(drop.linear.blk.CF)\n    AIC()\n  \n  #copper\n    anova(full.cp.CF, drop.stweight.cp.CF)\n    anova(full.cp.CF, drop.linear.cp.CF)\n\n  # % Weight gain calculation\n      cp.growth.data3$weight.change.percent <- ((cp.growth.data3$weight.change/df.3.weight.cp$start.weight.cp)*100)\n\n    # Plot % weight gain\n      plot(cp.growth.data3$mean, cp.growth.data3$weight.change.percent, pch = 18, \n           bty = \"l\", main = \"% Weight Gain - Copper Rockfish\", ylab = \"% Weight Gain\", \n           xlab = \"Treatment Temperature (Celcius)\", col = \"blue\")\n\n      ggplot(cp.growth.data3, aes(x=mean, y=weight.change.percent)) + labs(x = \"Temperature (Celcius)\", \n            y = \"% Weight Gain\") + ggtitle(\"% Weight Gain - Copper Rockfish\") + geom_point() + geom_smooth()\n\n      plot(blk.growth.data3$mean, blk.growth.data3$weight.change.percent, pch = 20, \n          bty = \"l\", main = \"% Weight Gain - Black Rockfish\", ylab = \"% Weight Gain\", \n          xlab = \"Treatment Temperature\")\n  \n      ggplot(blk.growth.data3, aes(x=mean, y=weight.change.percent)) + labs(x = \"Temperature (Celcius)\", \n             y = \"% Weight Gain\") + ggtitle(\"% Weight Gain - Black Rockfish\") + geom_point() + geom_smooth()\n\n      ggplot(blk.growth.data3, aes(x=mean, y=end.weight)) + labs(x = \"Temperature (Celcius)\", \n           y = \" End Weight\") + ggtitle(\"END Weight - Black Rockfish\") + geom_point() + geom_smooth()\n\n# Initial simple models\n\n      sim.blk.WG <- lm(blk.growth.data3$weight.change.percent~blk.growth.data3$mean)\n      sim.cp.WG <- lm(cp.growth.data3$weight.change.percent~cp.growth.data3$mean)\n\n      quad.blk.WG <- lm(blk.growth.data3$weight.change.percent~I(blk.growth.data3$mean^2))\n      quad.cp.WG  <- lm(cp.growth.data3$weight.change.percent~I(cp.growth.data3$mean^2))\n\n# Full model with squared term and initial weight as a predictor\n\n    full.blk.WG <- lm(blk.growth.data3$weight.change.percent~blk.growth.data3$start.weight + poly(blk.growth.data3$mean, 2, raw=TRUE))\n    full.cp.WG <- lm(cp.growth.data3$weight.change.percent~cp.growth.data3$mean + I(cp.growth.data3$mean^2) + cp.growth.data3$start.weight)\n    summary(full.blk.WG)\n    summary(full.cp.WG)\n            \n   # dropping start.weight \n            \n    drop.stweight.blk.WG <- lm(blk.growth.data3$weight.change.percent~blk.growth.data3$mean + I(blk.growth.data3$mean^2))\n    drop.stweight.cp.WG <- lm(cp.growth.data3$weight.change.percent~cp.growth.data3$mean + I(cp.growth.data3$mean^2))\n    summary(drop.stweight.blk.WG)    \n    summary(drop.stweight.cp.WG)\n\n    \n    # dropping linear term\n            \n    drop.linear.blk.WG <- lm(blk.growth.data3$weight.change.percent~I(blk.growth.data3$mean^2) + blk.growth.data3$start.weight)  \n    drop.linear.cp.WG <- lm(cp.growth.data3$weight.change.percent~I(cp.growth.data3$mean^2) + cp.growth.data3$start.weight)\n    summary(drop.linear.blk.WG)\n    summary(drop.linear.cp.WG)\n            \n    # endweight \n      \n      full.endweight.blk.WG <- lm(blk.growth.data3$end.weight~blk.growth.data3$mean+I(blk.growth.data3$mean^2))\n  # comparing models\n            \n      #black\n        anova(full.blk.WG, drop.stweight.blk.WG)\n        anova(full.blk.WG, drop.linear.blk.WG)\n           \n        AICc(full.blk.WG)\n        AICc(drop.stweight.blk.WG)\n        AICc(drop.linear.blk.WG)\n        AICc(sim.blk.WG)\n        AICc(quad.blk.WG)\n    #copper\n        anova(full.cp.WG, drop.stweight.cp.WG)\n        anova(full.cp.WG, drop.linear.cp.WG) \n\n#### Mortality Data ####\n\n      mort <- read.csv(\"Mortality_Black.csv\")\n\n      mort.black <- which(mort$Species == \"Black\")\n      mort.black2 <- tapply(mort$Days_Survived[mort.black], mort$Treatment_Temperature[mort.black],mean)\n      df.mort.black <- data.frame(temp=names(mort.black2), mort.black2)\n\n      mort.copper <- which(mort$Species == \"Copper\")\n      mort.copper2 <- tapply(mort$Days_Survived[mort.copper], mort$Treatment_Temperature[mort.copper],mean)\n      df.mort.copper <- data.frame(temp=names(mort.copper2), mort.copper2)\n\n      boxplot(mort$Days_Survived[mort.copper]~mort$Treatment_Temperature[mort.copper], \n              xlab = \"Temperature Treatment (Celcius)\", ylab = \"Days Survived\", \n              ylim = c(1, 14), main = \"Copper Rockfish Mortality\")\n      boxplot(mort$Days_Survived[mort.black]~mort$Treatment_Temperature[mort.black], \n              xlab = \"Temperature Treatment (Celcius)\", ylab = \"Days Survived\", \n              ylim = c(1, 14), main = \"Black Rockfish Mortality\")\n\n#### Respiration Rate Data ####\n\nresp  <- read.csv(\"Fish_Measurement_Data_2.csv\")\nhead(resp)\ndf.resp <- subset(resp, select = c(\"Species\", \"Length_mm\", \"Weight_g\", \"Starting_DO_.ppm\", \"DO_30min_ppm\", \n                                   \"Experimental_Treatment_C\", \"Bucket\"))\ndf.respiration <- na.omit(df.resp)\n\n# Calculate Respiration Rate\n  df.respiration$respirationrate <- (df.respiration$Starting_DO_.ppm-df.respiration$DO_30min_ppm)/30\n\n# Take only positive values\n  df.respiration_pos <- df.respiration[df.respiration$respirationrate > 0, ]\n\n# subset data for the two species\n  copper <- df.respiration_pos[df.respiration_pos$Species==\"Copper\", ] \n  black <- df.respiration_pos[df.respiration_pos$Species %in% c(\"Black\", \"Yellowtail\", \"Silver\"), ]\n\n# put in experimental treatment temperatures\n  black$exp_temp  <- c(10.33846, 10.33846, 10.33846, 10.45769, 10.45769, 18.48462,\n                       18.48462, 18.48462, 20.18269, 20.18269, 20.18269, 13.46111,\n                       13.46111, 20.71346, 20.71346, 20.71346, 20.97308, 20.97308, \n                       22.61731, 22.61731, 19.35962, 19.35962, 19.35962, 15.23462,\n                       15.23462, 15.23462, 19.98462, 19.98462, 17.86923, 17.86923,\n                       17.86923, 13.89808, 13.89808, 22.35682, 22.35682, 19.45192,\n                       19.45192, 19.45192)\n\n  copper$exp_temp <- c(10.58704, 10.58704, 10.51111, 10.51111, 10.51111, 10.51111,\n                       19.22222, 19.22222, 19.22222, 19.91852, 19.91852, 19.91852, \n                       21.03333, 21.03333, 13.46111, 13.46111, 13.46111, 13.46111, \n                       22.01296, 22.01296, 22.01296, 21.40741, 21.40741, 21.40741, \n                       22.85417, 17.97037, 17.97037, 17.97037, 17.97037, 15.10000, \n                       15.10000, 18.90926, 18.90926, 18.90926, 17.15000, 17.15000, \n                       17.15000, 13.71667, 19.98889, 19.98889)\n\n\n\n\n# Plot log of respiration against the log of growth\n  plot(log(copper$respirationrate)~log(copper$Weight_g), bty = \"l\",\n       xlim=c(-2.5, 1.5), ylim = c(-7,-3), pch = 18, col = \"blue\", \n       main = \"Linear Regression of Respiration Rate and Weight\", \n       xlab = \"log10(Weight)\", ylab = \"log10(Respiration Rate)\")\n  points(log(black$respirationrate)~log(black$Weight_g), pch = 20, col = \"black\")\n\n \n  abline(lm(log(copper$respirationrate)~log(copper$Weight_g)), col = \"blue\")\n  abline(lm(log(black$respirationrate)~log(black$Weight_g)), col = \"black\")\n\n  text(-1, -6.5, adj = c(0,0), labels = \"copper: p = 0.14,  R^2 = 0.17\", col = \"blue\")\n  text(-1, -7, adj = c(0,0), labels = \"black: p = 0.0059*,  R^2 = 0.54\", col = \"black\")\n\n# Get linear model data and print the summary\n  copper_linear_model <- lm(log(copper$respirationrate)~log(copper$Weight_g)+copper$exp_temp)\n  black_linear_model <- lm(log(black$respirationrate)~log(black$Weight_g)+black$exp_temp)\n\n  fish  <- rbind(copper, black)\n\n  fish$Species[fish$Species==\"Yellowtail\"] <-\"Black\"\n  fish$Species[fish$Species==\"Silver\"] <-\"Black\"\n\n  fish_linear_model <- lm(log(fish$respirationrate)~log(fish$Weight_g)+fish$exp_temp*fish$Species)\n\n  summary(fish_linear_model)\n  summary(copper_linear_model)\n  summary(black_linear_model)\n\n# Plot both species\n # plot(log(fish$respirationrate)~log(fish$Weight_g), bty = \"l\", pch = 20,\n #      ylab = \"log10(Respiration Rate)\", xlab = \"log10(Weight)\", \n #      main = \"Linear Regression of Respiration Rate and Fish Weight\")\n #abline(lm(log(fish$respirationrate)~log(fish$Weight_g)))\n  \n# Full data set - dividing by weight\n  fish$adjrespirationrate = (fish$respirationrate/(fish$Weight_g))\n\n  # Plot and Model\n  #  plot(fish$exp_temp, fish$adjrespirationrate, bty = \"l\", pch = 20,\n  #       main = \"Respiration Rate for Full Dataset\", ylab = \"Respiration Rate (mg g-1 min-1)\",\n  #       xlab = \"Experimental Temperature (Celcius)\")\n  #  abline(lm(fish$adjrespirationrate~fish$exp_temp))\n  #  text(13, 0.08, labels = \"Interaction: p = 0.74\")\n  #  text(13, 0.07, labels = \"Slope: p = 0.086\")\n  #  fish_linear_model2 <- lm(fish$adjrespirationrate~fish$exp_temp + fish$Species*fish$exp_temp)\n    \n  #  summary(fish_linear_model2)\n\n# Individual Species Model - Use slope and intercept to parameterize the scaling equation\n  copper$adjrespirationrate = (copper$respirationrate/(copper$Weight_g))\n  black$adjrespirationrate = (black$respirationrate/(black$Weight_g))\n\n# Plot the adjusted respiration rate against the experimental temperature\n  plot(copper$exp_temp, copper$adjrespirationrate, bty = \"l\", pch = 18,\n       main = \"Copper Rockfish Respiration Rate\", ylab = \"Respiration Rate (mg g-1 min-1)\",\n       xlab = \"Experimental Temperature (Celcius)\", col = \"blue\")\n  abline(lm(copper$adjrespirationrate~copper$exp_temp), col = \"blue\")\n  text(15, 0.07, labels = \"p = 0.298, R^2 = 0.03\")\n  summary(lm(copper$adjrespirationrate~copper$exp_temp))\n\n  plot(black$exp_temp, black$adjrespirationrate, bty = \"l\", pch = 20,\n       main = \"Black Rockfish Respiration Rate\", ylab = \"Respiration Rate (mg g-1 min-1)\",\n       xlab = \"Experimental Temperature (Celcius)\", col = \"black\")\n  abline(lm(black$adjrespirationrate~black$exp_temp), col = \"black\")\n  text(15, 0.04, labels = \"p = 0.0050*, R^2 = 0.20\")\n  summary(lm(black$adjrespirationrate~black$exp_temp))\n\n  plot(copper$exp_temp, copper$respirationrate, bty = \"l\", pch = 20,\n       main = \"Copper Rockfish Respiration Rate\", ylab = \"Respiration Rate\",\n       xlab = \"Experimental Temperature\")\n\n   plot(black$exp_temp, black$respirationrate, bty = \"l\", pch = 18,\n       main = \"Black Rockfish Respiration Rate\", ylab = \"Respiration Rate\",\n       xlab = \"Experimental Temperature\", col = \"blue\")\n\n   \n  ",
    "created" : 1478146119608.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1603378572",
    "id" : "D18E1A5A",
    "lastKnownWriteTime" : 1478633127,
    "last_content_update" : 1478633127213,
    "path" : "~/Documents/Northeastern/Lotterhos_Lab/Field Work/2015/TPC_Experiment/Analysis/Temp_Analysis.R",
    "project_path" : "Temp_Analysis.R",
    "properties" : {
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}