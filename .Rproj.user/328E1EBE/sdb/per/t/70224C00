{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Species_Respiration_Rate\"\nauthor: \"Sara Michele Schaal\"\ndate: \"June 26, 2016\"\noutput: pdf_document\n---\n\nData import and manipulation \n\n```{r}\n\ndata <- read.csv(\"Fish_Measurement_Data_w_IDs_seq_4.csv\")\n\ndata.2 <- subset(data, select = c(\"Date\", \"Species_Seq\", \"Weight_g\", \"Starting_DO_.ppm\", \"DO_30min_ppm\", \"Bucket\"))\n\ndata.2.blk <- data.2[data.2$Date == 20150630,] \ndata.2.cp <- data.2[data.2$Date == 20150714,]\n\ndata.3.blk <- na.omit(data.2.blk)\ndata.3.cp <- na.omit(data.2.cp)\n\ndata.3.blk$Res_Rate <- (data.3.blk$Starting_DO_.ppm-data.3.blk$DO_30min_ppm)/30\ndata.3.blk$Wei_Res_Rate <- data.3.blk$Res_Rate/data.3.blk$Weight_g\n\n\ndata.3.blk$exp_temp <- c(10.45769, 10.45769, 10.33846, 10.33846, 10.33846, 14.09038,\n                       14.09038, 13.89808, 13.89808, 15.23462, 15.23462, 17.86923,\n                       17.86923, 17.86923, 19.35962, 19.35962, 19.35962, 18.48462,\n                       18.48462, 18.48462, 19.98462, 19.98462, 19.98462, 19.45192, \n                       19.45192, 19.45192, 20.18269, 20.18269, 20.18269, 20.71346, \n                       20.71346, 20.71346, 20.97308, 20.97308, 22.61731, 22.61731, \n                       22.35682, 22.35682)\n                       \ndata.3.cp$Res_Rate  <- (data.3.cp$Starting_DO_.ppm-data.3.cp$DO_30min_ppm)/30\ndata.3.cp$Wei_Res_Rate <- data.3.cp$Res_Rate/data.3.cp$Weight_g\n\ndata.3.cp$exp_temp <- c(10.51111, 10.51111, 10.51111, 10.51111, 10.58704, 10.58704,\n                        13.46111, 13.46111, 13.46111, 13.46111, 13.71667, 13.71667, \n                        13.71667, 15.10000, 15.10000, 15.10000, 17.15000, 17.15000,\n                        17.15000, 17.97037, 17.97037, 17.97037, 17.97037, 19.22222,\n                        19.22222, 19.22222, 18.90926, 18.90926, 18.90926, 19.98889,\n                        19.98889, 19.91852, 19.91852, 19.91852, 21.03333, 21.03333, \n                        21.40741, 21.40741, 21.40741, 22.01296, 22.01296, 22.01296,\n                        22.85417, 22.85417)                      \n\n```\n\nSubset based on species\n\n```{r}\n\ndata.3.black  <- data.3.blk[data.3.blk$Species_Seq == \"Black\",]\ndata.3.yellowtail <- data.3.blk[data.3.blk$Species_Seq == \"Yellowtail\",]\ndata.3.by <- data.3.blk[data.3.blk$Species_Seq == \"B/Y\",]\ndata.3.bunknown <- data.3.blk[data.3.blk$Species_Seq == \"\",]\ndata.blkAyt <- data.3.blk[data.3.blk$Species_Seq == c(\"Black\", \"Yellowtail\"),]\n\ndata.3.copper <- data.3.cp[data.3.cp$Species_Seq == \"Copper\",]\ndata.3.quillback <- data.3.cp[data.3.cp$Species_Seq == \"Quillback\",]\ndata.3.unknown <- data.3.cp[data.3.cp$Species_Seq == \"\",]\n\n\n\n\n```\n\nBlack Rockfish Experiment: Plotting\n\n```{r}\npar(mfrow = c(2,1))\nplot( data.3.black$exp_temp, data.3.black$Wei_Res_Rate, pch = 20, bty = \"l\",\n     ylim = c(0, 0.055),\n     main = \"Black Rockfish\", \n     ylab = \"Respiration Rate (ppm O2 min-1)\",\n     xlab = \"\")\n\nplot(data.3.yellowtail$exp_temp, data.3.yellowtail$Wei_Res_Rate, pch = 20, \n     ylim = c(0,0.055),\n     col = \"goldenrod\", bty = \"l\",\n     main = \"Yellowtail Rockfish\",\n     ylab = \"\",\n     xlab = \"Experimental Temperature (Celcius)\")\n\nplot(data.3.by$exp_temp, data.3.by$Wei_Res_Rate, pch = 20, \n     col = \"darkgrey\", bty = \"l\",\n     main = \"B/Y sequencing Rockfish\",\n     ylab = \"Respiration Rate (ppm O2 min-1)\",\n     xlab = \"\")\n\nplot(data.3.bunknown$exp_temp, data.3.bunknown$Wei_Res_Rate, pch = 20, \n     col = \"blue\", bty = \"l\",\n     main = \"Not sequenced yet\",\n     ylab = \"\",\n     xlab = \"Experimental Temperature (Celcius)\")\n\n#Black and Yellowtail together\n\ndev.off()\nplot( data.3.black$exp_temp, data.3.black$Wei_Res_Rate, pch = 20, bty = \"l\",\n     ylim = c(0, 0.055),\n     main = \"Black and Yellowtail Rockfish\", \n     ylab = \"Respiration Rate (ppm O2 min-1 g-1)\",\n     xlab = \"Treatment Temperature (Celcius)\")\n\npoints(data.3.yellowtail$exp_temp, data.3.yellowtail$Wei_Res_Rate, pch = 15, \n     col = \"goldenrod\")\n\npoints(data.3.by$exp_temp, data.3.by$Wei_Res_Rate, pch = 17, col = \"darkred\")\n\nlegend(\"topleft\", legend = c(\"Black\", \"Yellowtail\", \"Hybrid\"), pch = c(20, 15, 17), col = c(\"black\", \"goldenrod\", \"darkred\"))\n\n#Not sequenced\nplot(data.3.bunknown$exp_temp, data.3.bunknown$Wei_Res_Rate, pch = 20, \n     ylim=c(0,0.055),\n     col = \"blue\", bty = \"l\",\n     main = \"Not sequenced yet\",\n     ylab = \"Respiration Rate (ppm O2 min-1 g-1)\",\n     xlab = \"Experimental Temperature (Celcius)\")\n\n\n\n\n```\n\nAnalysis Black Rockfish Experiment\n\n# Black and Yellowtail together to determine if there is a significant species interaction\n\n```{r}\n\nmod1.resp.blkAyt <- lm()\nsummary(mod1.resp.blkAyt)\ndrop1(mod1.resp.blkAyt)\n\n```\n\n```{r}\n\nfull.mod1.yellowtail <- lm(data.3.yellowtail$Wei_Res_Rate~data.3.yellowtail$exp_temp + I(data.3.yellowtail$exp_temp^2)) \nsummary(full.mod1.yellowtail)\ndrop1(full.mod1.yellowtail)\n#best model not significant\n\n```\n\nPlotting Copper Rockfish Experiment\n\n```{r}\n\npar(mfrow=c(3,1))\nplot(data.3.copper$exp_temp, data.3.copper$Wei_Res_Rate, pch = 20,\n     col = \"orange\", bty = \"l\", main = \"Copper Rockfish\",\n     xlab = \"\", ylab = \"\")\n\nplot(data.3.quillback$exp_temp, data.3.quillback$Wei_Res_Rate, pch = 20,\n     col = \"brown\", bty = \"l\", main = \"Quillback Rockfish\",\n     ylab = \"Respiration Rate (ppm O2 min-1)\", xlab = \"\")\n\nplot(data.3.unknown$exp_temp, data.3.unknown$Wei_Res_Rate, pch = 20,\n     col = \"blue\", bty = \"l\", main = \"Not Sequenced Yet\", \n     xlab = \"Experimental Temperature (Celcius)\", ylab = \"\")\n\n```\n\nCopper Analysis\n\n```{r}\n\n##Copper Analysis##\n\nfull.cp.mod1 <- lm(data.3.copper$Res_Rate~data.3.copper$exp_temp + I(data.3.copper$exp_temp^2) + I(data.3.copper$exp_temp^3))\nsummary(full.cp.mod1)\ndrop1(full.cp.mod1)\n#best model\n\nabline(full.cp.mod1)\n\ncurve(2.426e-01 - 4.724e-02*x + 2.973e-03*x^2 - 5.970e-05*x^3, add = T, col = \"goldenrod\", lwd = 1)\nf  <- function(x) (2.426e-01 - 4.724e-02*x + 2.973e-03*x^2 - 5.970e-05*x^3)\noptimize(f, c(10.22846, 22.61731), maximum = TRUE)\npoints(20.03268, 0.009400655, col = \"goldenrod\", pch = \"|\", lwd = 6)\ntext(13, 0.01, labels = expression(paste(\"T opt = 20.0\",degree,\"C\")), col = \"black\")\n\n##Quillback Analysis##\n\nfull.qb.mod1 <- lm(data.3.quillback$Res_Rate~data.3.quillback$exp_temp + I(data.3.quillback$exp_temp^2) + I(data.3.quillback$exp_temp^3))\nsummary(full.qb.mod1)\ndrop1(full.qb.mod1)\n#best model no significance\n\n\n\n```\n\n```{r}\n\nzeros.blk  <- read.csv(\"zeros_blk.csv\", header = FALSE)\ncolnames(zeros.blk) <- c(\"Date\", \"Species_Seq\", \"Weight_g\", \"Starting_DO_.ppm\", \"DO_30min_ppm\", \"Bucket\", \"Res_Rate\", \"Wei_Res_Rate\", \"exp_temp\")\nblack.zeros <- rbind(data.3.blk, zeros.blk)\n\nzeros.cp  <- read.csv(\"zeros_cp.csv\", header = FALSE)\ncolnames(zeros.cp) <- c(\"Date\", \"Species_Seq\", \"Weight_g\", \"Starting_DO_.ppm\", \"DO_30min_ppm\", \"Bucket\", \"Res_Rate\", \"Wei_Res_Rate\", \"exp_temp\")\ncopper.zeros <- rbind(data.3.cp, zeros.cp)\n\nblack.zeros.2  <- black.zeros[black.zeros$Species_Seq == \"Black\",]\nyellowtail.zeros <- black.zeros[black.zeros$Species_Seq == \"Yellowtail\",]\nby.zeros <- black.zeros[black.zeros$Species_Seq == \"B/Y\",]\nbunknown.zeros <- black.zeros[black.zeros$Species_Seq == \"\",]\ndata.zeros.blkAyt <- rbind(black.zeros.2, yellowtail.zeros)\n\ncopper.zeros.2 <- copper.zeros[copper.zeros$Species_Seq == \"Copper\",]\ncopper.zeros.2 <- copper.zeros.2[!(copper.zeros.2$Wei_Res_Rate < 0),]\nquillback.zeros <- copper.zeros[copper.zeros$Species_Seq == \"Quillback\",]\nunknown.zeros <- copper.zeros[copper.zeros$Species_Seq == \"\",]\ndata.zeros.cpAqb <- rbind(copper.zeros.2, quillback.zeros)\n\n\nwrite.csv(black.zeros.2, \"resp_species_black.csv\")\nwrite.csv(yellowtail.zeros, \"resp_species_yellowtail.csv\")\nwrite.csv(copper.zeros.2, \"resp_species_copper.csv\")\nwrite.csv(quillback.zeros, \"resp_species_quillback.csv\")\n\n\n```\n\nPlotting with zeros data\n\nBlack Rockfish Experiment\n\n\n```{r}\ndev.off()\nplot(black.zeros.2$exp_temp, black.zeros.2$Wei_Res_Rate, pch = 20, bty = \"l\",\n     ylim = c(0, 0.055), lwd = 4,\n     main = \"Black Rockfish Experiment\", \n     ylab = \"Respiration Rate (ppm O2 min-1 g-1)\",\n     xlab = expression(paste(\"Temperature (\",degree,\"C)\")))\n\npoints(yellowtail.zeros$exp_temp, yellowtail.zeros$Wei_Res_Rate, pch = 15, \n       col = \"goldenrod\", lwd = 4)\n\n#points(by.zeros$exp_temp, by.zeros$Wei_Res_Rate, pch = 17, \n#       col = \"darkred\")\n\nlegend(\"topleft\", legend = c(\"Black\", \"Yellowtail\"), pch = c(20, 15), col = c(\"black\", \"goldenrod\"))\n\nplot(bunknown.zeros$exp_temp, bunknown.zeros$Wei_Res_Rate, pch = 20, \n     ylim=c(0,0.055),\n     col = \"blue\", bty = \"l\",\n     main = \"Not sequenced yet\",\n     ylab = \"Respiration Rate (ppm O2 min-1 g-1)\",\n     xlab = \"Experimental Temperature (Celcius)\")\n\n```\n\n# Analyze Black and Yellowtail Rockfish together to determine if there is a significant species interaction\n\n```{r}\n\nmod1.resp.blkAyt <- lm(data.zeros.blkAyt$Wei_Res_Rate~data.zeros.blkAyt$exp_temp*data.zeros.blkAyt$Species_Seq + I(data.zeros.blkAyt$exp_temp^2))\nsummary(mod1.resp.blkAyt)\ndrop1(mod1.resp.blkAyt)\n# Significant Species Interaction ANALYZE SEPARATELY\n\n```\n\n# Analyzing Black and Yellowtail Rockfish separately \n\n```{r}\n\nmod1.zeros.blk <- lm(black.zeros.2$Wei_Res_Rate~black.zeros.2$exp_temp + I(black.zeros.2$exp_temp^2))\nsummary(mod1.zeros.blk)\ndrop1(mod1.zeros.blk)\n\ncurve\n\nmod2.zeros.blk <- lm(black.zeros.2$Wei_Res_Rate~black.zeros.2$exp_temp)\nsummary(mod2.zeros.blk)\n\n\ncurve(-0.0297770 + 0.0062169 *x -0.0001842*x^2, add = T, col = \"black\", lwd = 1)\n\nmod1.zeros.yt <- lm(yellowtail.zeros$Wei_Res_Rate~yellowtail.zeros$exp_temp + I(yellowtail.zeros$exp_temp^2))\nsummary(mod1.zeros.yt)\ndrop1(mod1.zeros.yt)\n\n\n```\n\nCopper Rockfish Experiment with zeros\n\n# Analyze together to determine if there is a significant species interaction\n\n```{r}\n\nmod1.resp.cpAqb <- lm(data.zeros.cpAqb$Wei_Res_Rate~data.zeros.cpAqb$exp_temp*data.zeros.cpAqb$Species_Seq + I(data.zeros.cpAqb$exp_temp^2))\nsummary(mod1.resp.cpAqb)\ndrop1(mod1.resp.cpAqb)\n# Significant Species Interaction analyze separately\n\n```\n\n# Copper and Quillback Separate\n\n```{r}\n\nplot(copper.zeros.2$exp_temp, copper.zeros.2$Wei_Res_Rate, pch = 20,\n     col = \"orange\", bty = \"l\", main = \"Copper Rockfish\", lwd = 4,\n     ylab = \"Respiration Rate (ppm O2 min-1 g-1)\", \n     xlab = expression(paste(\"Temperature (\",degree,\"C)\")))\n\npoints(quillback.zeros$exp_temp, quillback.zeros$Wei_Res_Rate, pch = 20,\n     col = \"brown\", lwd = 4)\n\nplot(data.3.unknown$exp_temp, data.3.unknown$Wei_Res_Rate, pch = 20,\n     col = \"blue\", bty = \"l\", main = \"Not Sequenced Yet\", \n     xlab = \"Experimental Temperature (Celcius)\", \n     ylab = \"Respiration Rate (ppm O2 min-1 g-1)\")\n\n\n```\n\n```{r}\n\nmod1.zeros.cp <- lm(copper.zeros.2$Wei_Res_Rate~copper.zeros.2$exp_temp + I(copper.zeros.2$exp_temp^2) + I(copper.zeros.2$exp_temp^3))\nsummary(mod1.zeros.cp)\ndrop1(mod1.zeros.cp)\n#best model all significant\n\nmod2.zeros.cp <- lm(copper.zeros.2$Wei_Res_Rate~copper.zeros.2$exp_temp + I(copper.zeros.2$exp_temp^2))\nsummary(mod2.zeros.cp)\ndrop1(mod2.zeros.cp)\n\nplot(copper.zeros.2$exp_temp, copper.zeros.2$Wei_Res_Rate, pch = 20,\n     col = \"orange\", bty = \"l\", main = \"Copper Rockfish\",\n     ylab = \"Respiration Rate (ppm O2 min-1 g-1)\", \n     xlab = \"Experimental Temperature (Celcius)\")\n\ncurve(-0.0146099 +  0.0039313*x - 0.0001123*x^2 , add = T, col = \"goldenrod\", lwd = 1)\n\n# f  <- function(x) (0.5732 - 0.1096*x + 0.006933*x^2 - 0.0001412*x^3)\n# optimize(f, c(10.22846, 22.61731), maximum = TRUE)\n# points(19.39, 0.02530859, col = \"black\", pch = \"|\", lwd = 6)\n# text(13, 0.04, labels = expression(paste(\"T opt = 19.4\",degree,\"C\")), col = \"black\")\n\npoints(quillback.zeros$exp_temp, quillback.zeros$Wei_Res_Rate, pch = 20,\n     col = \"brown\", bty = \"l\", main = \"Quillback Rockfish\",\n     ylab = \"Respiration Rate (ppm O2 min-1 g-1)\", \n     xlab = \"Experimental Temperature (Celcius)\", ylim = c(0, 0.07))\n\n\nmod1.quillback <- lm(quillback.zeros$Wei_Res_Rate~quillback.zeros$exp_temp + I(quillback.zeros$exp_temp^2) + I(quillback.zeros$exp_temp^3))\nsummary(mod1.quillback)\ndrop1(mod1.quillback)\n#best model not significant\n\nmod2.quillback <- lm(quillback.zeros$Wei_Res_Rate~quillback.zeros$exp_temp)\nsummary(mod2.quillback)\n\nabline(mod2.quillback)\n```\n\n",
    "created" : 1466995165495.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1464969320",
    "id" : "70224C00",
    "lastKnownWriteTime" : 1478995196,
    "last_content_update" : 1478995203466,
    "path" : "~/Documents/Northeastern/Lotterhos_Lab/Field Work/2015/TPC_Experiment/Analysis/species_respiration_rate.Rmd",
    "project_path" : "species_respiration_rate.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 0,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}