{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Species_Individual_Growth\"\nauthor: \"Sara Michele Schaal\"\ndate: \"November 8, 2016\"\noutput: pdf_document\n---\n\n```{r}\n\ndf.growth <- read.csv(\"Fish_Measurement_Data_w_IDs_seq_4.csv\")\n\n  # Subset Dataframe to Include only Those Necessary for Analysis\n    df.subgrowth  <- subset(df.growth, select = c(\"Date\", \"Species_Seq\", \"Length_mm\", \"Weight_g\",\n                                                  \"Individual_IDs\", \"Experimental_Treatment_C\",\n                                                  \"Bucket\"))\n\n  # Remove columns with any NAs\n    df.completegrowth <- na.omit(df.subgrowth)\n\n  # Correct start and end days for two experiments\n    start.day.blk <- subset(df.completegrowth, df.completegrowth$Date==20150620)\n    last.day.blk <- subset(df.completegrowth, df.completegrowth$Date==20150703)\n    start.day.cp <- subset(df.completegrowth, df.completegrowth$Date==20150704)\n    last.day.cp <- subset(df.completegrowth, df.completegrowth$Date==20150718)\n\n    write.csv(last.day.blk, \"last_day_black.csv\")\n    write.csv(last.day.cp, \"last_day_copper.csv\")\n    write.csv(start.day.blk, \"start.day.blk.csv\")\n    write.csv(start.day.cp, \"start.day.cp.csv\")\n    \n    copper.data <- read.csv(\"Copper_Weight.csv\", header = TRUE)\n    black.data <- read.csv(\"Black_Weight.csv\", header = TRUE)\n    \n    # Get weight change\n    copper.data$Per_Weight <- ((copper.data$End_Weight - copper.data$Start_Weight)/(copper.data$Start_Weight))*100\n    black.data$Per_Weight <- ((black.data$End_Weight - black.data$Start_Weight)/(black.data$Start_Weight))*100\n    \n    # Get Condition Factor\n    copper.data$CF <- ((copper.data$End_Weight/(copper.data$End_Length)^3)*100)-((copper.data$Start_Weight/(copper.data$Start_Length)^3)*100)\n    black.data$CF <- ((black.data$End_Weight/(black.data$End_Length)^3)*100)-((black.data$Start_Weight/(black.data$Start_Length)^3)*100)\n    \n```\n\n```{r}\n# Set Bucket to Correct Experimental Temperature \n# Copper\nfor (i in 1:nrow(copper.data)){\n  if(copper.data$Bucket[i] == 1){\n    copper.data$Bucket[i] <- replace(copper.data$Bucket[i], 1, 10.51111)\n  }else if(copper.data$Bucket[i] == 2){\n    copper.data$Bucket[i] <- replace(copper.data$Bucket[i], 1, 10.58704)\n  }else if(copper.data$Bucket[i] == 3){\n    copper.data$Bucket[i] <- replace(copper.data$Bucket[i], 1, 13.46111)\n  }else if(copper.data$Bucket[i] == 4){\n    copper.data$Bucket[i] <- replace(copper.data$Bucket[i], 1, 13.71667)\n  }else if(copper.data$Bucket[i] == 5){\n    copper.data$Bucket[i] <- replace(copper.data$Bucket[i], 1, 15.10000)\n  }else if(copper.data$Bucket[i] == 6){\n    copper.data$Bucket[i] <- replace(copper.data$Bucket[i], 1, 17.15000)\n  }else if(copper.data$Bucket[i] == 7){\n    copper.data$Bucket[i] <- replace(copper.data$Bucket[i], 1, 17.97037)\n  }else if(copper.data$Bucket[i] == 8){\n    copper.data$Bucket[i] <- replace(copper.data$Bucket[i], 1, 19.22222)\n  }else if(copper.data$Bucket[i] == 9){\n    copper.data$Bucket[i] <- replace(copper.data$Bucket[i], 1, 18.90926)\n  }else if(copper.data$Bucket[i] == 10){\n    copper.data$Bucket[i] <- replace(copper.data$Bucket[i], 1, 19.98889)\n  }else if(copper.data$Bucket[i] == 11){\n    copper.data$Bucket[i] <- replace(copper.data$Bucket[i], 1, 19.91852)\n  }else if(copper.data$Bucket[i] == 12){\n    copper.data$Bucket[i] <- replace(copper.data$Bucket[i], 1, 21.03333)\n  }else if(copper.data$Bucket[i] == 13){\n    copper.data$Bucket[i] <- replace(copper.data$Bucket[i], 1, 21.40741)\n  }else {\n    copper.data$Bucket[i] <- replace(copper.data$Bucket[i], 1, 22.01296)\n  }\n}\n\n#Black\nfor (i in 1:nrow(black.data)){\n  if(black.data$Bucket[i] == 1){\n    black.data$Bucket[i] <- replace(black.data$Bucket[i], 1, 10.45769)\n  }else if(black.data$Bucket[i] == 2){\n    black.data$Bucket[i] <- replace(black.data$Bucket[i], 1, 10.33846)\n  }else if(black.data$Bucket[i] == 3){\n    black.data$Bucket[i] <- replace(black.data$Bucket[i], 1, 14.09038)\n  }else if(black.data$Bucket[i] == 4){\n    black.data$Bucket[i] <- replace(black.data$Bucket[i], 1, 13.89808)\n  }else if(black.data$Bucket[i] == 5){\n    black.data$Bucket[i] <- replace(black.data$Bucket[i], 1, 15.23462)\n  }else if(black.data$Bucket[i] == 6){\n    black.data$Bucket[i] <- replace(black.data$Bucket[i], 1, 17.86923)\n  }else if(black.data$Bucket[i] == 7){\n    black.data$Bucket[i] <- replace(black.data$Bucket[i], 1, 19.35962)\n  }else if(black.data$Bucket[i] == 8){\n    black.data$Bucket[i] <- replace(black.data$Bucket[i], 1, 18.48462)\n  }else if(black.data$Bucket[i] == 9){\n    black.data$Bucket[i] <- replace(black.data$Bucket[i], 1, 19.98462)\n  }else if(black.data$Bucket[i] == 10){\n    black.data$Bucket[i] <- replace(black.data$Bucket[i], 1, 19.45192)\n  }else if(black.data$Bucket[i] == 11){\n    black.data$Bucket[i] <- replace(black.data$Bucket[i], 1, 20.18269)\n  }else if(black.data$Bucket[i] == 12){\n    black.data$Bucket[i] <- replace(black.data$Bucket[i], 1, 20.71346)\n  }else if(black.data$Bucket[i] == 13){\n    black.data$Bucket[i] <- replace(black.data$Bucket[i], 1, 20.97308)\n  }else {\n    black.data$Bucket[i] <- replace(black.data$Bucket[i], 1, 22.61731)\n  }\n}\n\n# Remove bad data point in copper\ncopper.data <- copper.data[-34,]\n```\n \n```{r}\n# Black Analysis Species Interaction\n\nmod1_blkAyt <- lm(black.data$Per_Weight~black.data$Bucket*black.data$Species_Seq)\nsummary(mod1_blkAyt)\ndrop1(mod1_blkAyt)\n\nmod2_blkAyt <- lm(black.data$Per_Weight~black.data$Bucket + black.data$Species_Seq)\nsummary(mod2_blkAyt)\ndrop1(mod2_blkAyt)\n\nmod3_blkAyt <- lm(black.data$Per_Weight~black.data$Bucket)\nsummary(mod3_blkAyt)\n#Analyze together\n\nmod4_blkAyt <- lm(black.data$Per_Weight~black.data$Bucket + black.data$Start_Weight)\nsummary(mod4_blkAyt)\n\nabline(mod3_blkAyt, lwd = 3)\n\nmod1_cpAqb <- lm(copper.data$Per_Weight~copper.data$Bucket*copper.data$Species_Seq)\nsummary(mod1_cpAqb)\ndrop1(mod1_cpAqb)\n#Analyze separate\n\nmod2_cpAqb <- lm(copper.data$Per_Weight~copper.data$Bucket + copper.data$Species_Seq)\nsummary(mod2_cpAqb)\ndrop1(mod2_cpAqb)\n\n\n```\n\n```{r}\n#Separating data\n\nblack.data.2 <- subset(black.data, black.data$Species_Seq == \"Black\")\nyellowtail.data <- subset(black.data, black.data$Species_Seq == \"Yellowtail\")\n\n# Black Rockfish Experiment\n\n # Percent Weight Change\n  plot(black.data.2$Per_Weight~black.data.2$Bucket, col = \"black\",\n       lwd = 5, pch = 20, bty = \"l\", ylab = \"Percent Weight Change\", \n     xlab = expression(paste(\"Temperature (\",degree,\"C)\")), \n     main = \"Black Rockfish Experiment\", \n     ylim = c(-40, 60))\n  \n  points(yellowtail.data$Per_Weight~yellowtail.data$Bucket, \n         col = \"goldenrod\", lwd = 5, pch = 20)\n  legend(\"topright\", legend = c(\"Black\", \"Yellowtail\"), \n         pch = c(20, 20), col = c(\"black\", \"goldenrod\"))\n\n  # Model\n  blk.mod1 <- lm(black.data.2$Per_Weight~black.data.2$Bucket +\n                   I(black.data.2$Bucket^2) + \n                   black.data.2$Start_Weight)\n  summary(blk.mod1)\n  drop1(blk.mod1)\n\n  blk.mod2 <- lm(black.data.2$Per_Weight~black.data.2$Bucket +\n                   I(black.data.2$Bucket^2))\n  summary(blk.mod2)\n  drop1(blk.mod2)\n\n  blk.mod3 <- lm(black.data.2$Per_Weight~black.data.2$Bucket + black.data.2$Start_Weight)\n  summary(blk.mod3)\n\n  abline(blk.mod3, lwd = 3)\n\n  yt.mod1 <- lm(yellowtail.data$Per_Weight~yellowtail.data$Bucket)\n  summary(yt.mod1)\n  abline(yt.mod1, col = \"goldenrod\", lwd = 3)\n\n#Condition Factor \n  plot(black.data.2$CF~black.data.2$Bucket)\n\n\n# Copper Analysis\n  copper.data.2 <- subset(copper.data, copper.data$Species_Seq == \"Copper\")\n  quillback.data <- subset(copper.data, copper.data$Species_Seq == \"Quillback\")\n\n#Copper Rockfish Experiment Plots\n plot(copper.data.2$Per_Weight~copper.data.2$Bucket, col = \"orange\",\n       lwd = 5, pch = 20, bty = \"l\", ylab = \"Percent Weight Change\", \n     xlab = \"Temperature\", main = \"Copper Rockfish Experiment\")\n points(quillback.data$Per_Weight~quillback.data$Bucket, col = \"brown\",\n        lwd = 5, pch = 20)\n legend(\"topright\", legend = c(\"Copper\", \"Quillback\"), \n         pch = c(20, 20), col = c(\"orange\", \"brown\"))\n\n \n # Model\n cp.mod1 <- lm(copper.data.2$Per_Weight~copper.data.2$Bucket +\n                   I(copper.data.2$Bucket^2) + \n                   copper.data.2$Start_Weight)\n  summary(cp.mod1)\n  drop1(cp.mod1)\n\n  curve(-9.8697 + 0.2252*x - 16.2028*x^2, add = T, col = \"goldenrod\", lwd = 1)\n  \n  cp.mod1.5 <- lm(copper.data.2$Per_Weight~copper.data.2$Bucket +\n                   copper.data.2$Start_Weight)\n  summary(cp.mod1.5)\n  cp.mod2 <- lm(copper.data.2$Per_Weight~copper.data.2$Bucket +\n                   I(copper.data.2$Bucket^2))\n  summary(cp.mod2)\n  drop1(cp.mod2)\n\n  cp.mod3 <- lm(copper.data.2$Per_Weight~copper.data.2$Bucket)\n  summary(cp.mod3)\n  abline(cp.mod3, col = \"orange\", lwd = 3)\n\n  qb.mod1 <- lm(quillback.data$Per_Weight~quillback.data$Bucket + quillback.data$Start_Weight)\n  summary(qb.mod1)\n  drop1(qb.mod1)\n  \n  abline(qb.mod1, col = \"brown\", lwd = 3)   \n```\n\n```{r}\n\n## Black Rockfish Experiment ##\n  plot(black.data$Per_Weight~black.data$Bucket, col = \"black\",\n       lwd = 5, pch = 20, bty = \"l\", ylab = \"Percent Weight Change\", \n       xlab = \"Temperature\", ylim = c(-40, 60), \n       main = \"Black Rockfish Experiment\", cex.lab = 1.5)\n  points(yellowtail.data$Per_Weight~yellowtail.data$Bucket, col = \"goldenrod\", \n       lwd = 5, pch = 20, bty = \"l\")\n  abline(blk.mod3, lwd = 3)\n  abline(yt.mod1, col = \"goldenrod\", lwd = 3)\n  legend(\"topright\", legend = c(\"Black\", \"Yellowtail\"), \n         pch = c(20, 20), col = c(\"black\", \"goldenrod\"))\n  \n## Copper Rockfish Experiment ##\n\n  plot(copper.data.2$Per_Weight~copper.data.2$Bucket, col = \"orange\",\n       lwd = 5, pch = 20, bty = \"l\", ylim = c(-40, 60), cex.lab = 1.5,\n       xlab = \"Temperature\", main = \"Copper Rockfish Experiment\", \n       ylab = \"\")\n  points(quillback.data$Per_Weight~quillback.data$Bucket, col = \"brown\",\n       lwd = 5, pch = 20, bty = \"l\")\n  abline(cp.mod3, col = \"orange\", lwd = 3)\n  abline(qb.mod1, col = \"brown\", lwd = 3)\n  legend(\"topright\", legend = c(\"Copper\", \"Quillback\"), pch = c(20,20),\n         col = c(\"orange\", \"brown\"))\n\n```",
    "created" : 1478627204697.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "16885437",
    "id" : "B689C9E",
    "lastKnownWriteTime" : 1478995209,
    "last_content_update" : 1478995209598,
    "path" : "~/Documents/Northeastern/Lotterhos_Lab/Field Work/2015/TPC_Experiment/Analysis/Species_Growth.Rmd",
    "project_path" : "Species_Growth.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}