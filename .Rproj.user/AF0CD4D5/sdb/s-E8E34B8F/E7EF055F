{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Mortality Data\"\nauthor: \"Sara Michele Schaal\"\ndate: \"3/7/2018\"\noutput:\n  pdf_document: default\n  html_document: default\n---\n\n## Load Relevant Packages\n```{r}\n    if(!(\"AICcmodavg\" %in% installed.packages())){\n      install.packages(\"AICcmodavg\")\n    }\n    if(!(\"car\" %in% installed.packages())){\n      install.packages(\"car\")\n    }\n    if(!(\"multcomp\" %in% installed.packages())){\n      install.packages(\"multcomp\")\n    }\n    if(!(\"lsmeans\" %in% installed.packages())){\n      install.packages(\"lsmeans\")\n    }\n    if(!(\"multcompView\" %in% installed.packages())){\n      install.packages(\"multcompView\")\n    }\n\n  library(AICcmodavg)\n  library(car)\n  library(multcomp)\n  library(lsmeans)\n  library(multcompView)\n```\n\n## Data Manipulation\n```{r}\n## Read In Data ##\n  mort.data <- read.csv(\"./data/Mortality.csv\")\n  # round temperature data\n  mort.data$Treatment_Temperature <- round(mort.data$Treatment_Temperature, digits = 1)\n  # remove those that could not be identified to the species level \n  mort.data <- mort.data[!mort.data$Species == \"\" & !mort.data$Species == \"Hybrid\",]\n  # calculate days dead and survived\n  mort.data$DaysDead <- 14-mort.data$Days_Survived\n  mort.data$PropDaysSurv <- mort.data$Days_Survived/14\n  \n\n## Combine Black and Yellowtail Data ##\n  # Make a new species column that combines black and yellowtail rockfish\n  mort.data$Species2 <- NA\n    \n  # Find all rows where species is either black or yellowtail and add BY to new species column\n  for(i in 1:nrow(mort.data)){\n    if(mort.data$Species[i] == \"Black\" | mort.data$Species[i] == \"Yellowtail\"){\n      mort.data$Species2[i] <- \"BY\"\n    } else {\n      mort.data$Species2[i] <- mort.data$Species[i]\n    }\n  }\n  # Factor new species column\n  mort.data$Species2 <- as.factor(mort.data$Species2)\n  # Set levels to meaningful names\n  levels(mort.data$Species2) <- c(\"Copper\", \"Quillback\", \"BY\")\n  \n  \n#### Combine Quillback and Copper ####\n  # Make a new species column that combines black and yellowtail rockfish\n  mort.data$Species3 <- NA\n    \n  # Find all rows where species is either black or yellowtail and add BY to new species column\n  for(i in 1:nrow(mort.data)){\n    if(mort.data$Species2[i] == \"Copper\" | mort.data$Species2[i] == \"Quillback\"){\n      mort.data$Species3[i] <- \"CQ\"\n    } else {\n      mort.data$Species3[i] <- mort.data$Species2[i]\n    }\n  }\n  # Factor new species column\n  mort.data$Species3 <- as.factor(mort.data$Species3)\n  # Change factor level names\n  levels(mort.data$Species3) <- c(\"BY\", \"CQ\") \n```\n\n# Analyses\n### Binomial - Temperature by Species\n```{r}\n################################\n#### Complex Level Analysis ####\n################################\n ## Logistic regression with interaction of temp and species where complexes are combined \n  log.mod.all.complex <- glm(cbind(Days_Survived, DaysDead)~Treatment_Temperature*Species3,\n                           family = binomial(link = 'logit'), data = mort.data)\n  summary(log.mod.all.complex)\n  Anova(log.mod.all.complex, type = 2)\n  ## Use capital Anova for sums of squares that equals Type II sums of squares where \n  ## the SS are calculated for the main effects but not the interaction and should \n  ## only be used when there is not a significant interaction statistically more \n  ## powerful then Type III\n  \n ## Check Assumptions ##\n  # Dispersion\n  var(mort.data$DaysDead) # 9.71\n  mean(mort.data$DaysDead) # 1.72\n  # Data are overdispersed\n  \n  # Diagnostic plots for outliers and intercorrelation\n  par(mfrow = c(2,2))\n  plot(log.mod.all.complex)\n  # variance is not equal across data points (scale-location plot) change to quasibinomial\n  \n  # Autocorrelation\n  par(mfrow = c(1,1))\n  acf(log.mod.all.complex$residuals)\n  # no autocorrelation  \n  \n## Switch to quasibinomial to relax data assumptions\n  ## (this will produce conservative p-values if you have overdispersion)\n  \n ## Logistic regression with interaction of temp and species where complexes are combined \n  quasi.mod.all.complex <- glm(cbind(Days_Survived, DaysDead)~Treatment_Temperature*Species3,\n                           family = quasibinomial(link = 'logit'), data = mort.data)\n  summary(quasi.mod.all.complex)\n  Anova(quasi.mod.all.complex, type = 2)\n  \n  # Significant interaction but check likelihood ratio test to ensure best model\n  quasi.mod.all.complex2 <- glm(cbind(Days_Survived, DaysDead)~Treatment_Temperature+Species3,\n                           family = quasibinomial(link = 'logit'), data = mort.data)\n  anova(quasi.mod.all.complex, quasi.mod.all.complex2, test = \"LRT\")\n  ## Model 1 with interaction is the best model\n  \n###################################\n#### Species in a Single Model ####\n###################################\n### All Four Species ##############\n## Logistic regression for the interaction between temperature and species on survival\n  log.mod.all.prop <- glm(cbind(Days_Survived, DaysDead)~Treatment_Temperature*Species, \n                            family = quasibinomial(link = 'logit'), data = mort.data)\n  summary(log.mod.all.prop)\n  summary(aov(log.mod.all.prop))\n  drop1(log.mod.all.prop)\n  # Best Model\n  # Giving warning because of the Yellowtail data. \n  # Its because the \"link\" score is very large. \n  # We have overfit our data.\n\n#####################\n#### BY Combined ####\n#####################\n ## Logistic regression with interaction of temp and species where BY combined \n  quasiModel1 <- glm(cbind(Days_Survived, DaysDead)~Treatment_Temperature*Species2, \n              family = quasibinomial(link = \"logit\"),\n              data = mort.data)\n  summary(quasiModel1)\n  Anova(quasiModel1, type = 2) \n  # Interaction is not significant check LRT\n\n  # dropping interaction term\n  quasiModel2 <- glm(cbind(Days_Survived, DaysDead)~Treatment_Temperature + Species2, \n              family = quasibinomial(link = \"logit\"),\n              data = mort.data)\n  anova(quasiModel1, quasiModel2,  test = \"LRT\")\n  # Can drop the interaction term due to nonsignificant LRT\n  Anova(quasiModel2, type = 2)\n  summary(quasiModel2)\n  \n  # run least-squares means to identify which species are different\n  multcompar <- lsmeans(quasiModel2, pairwise ~ Species2, adjust = \"Tukey\")\n  summary(multcompar)\n\n###################################  \n#### Individual Species Models ####\n###################################\n  \n## Black and Yellowtail ##  \n # Logistic Regression Model # \n  log.mod.blkyt.prop <- glm(cbind(mort.data$Days_Survived[mort.data$Species==\"Black\"\n                                                         | mort.data$Species==\"Yellowtail\"],\n                                  mort.data$DaysDead[mort.data$Species==\"Black\" \n                                                         | mort.data$Species==\"Yellowtail\"])\n                              ~Treatment_Temperature,\n                            family = binomial(link = 'logit'), \n                            data = mort.data[mort.data$Species==\"Black\" \n                                              | mort.data$Species==\"Yellowtail\",])\n  summary(log.mod.blkyt.prop)\n\n### Copper Rockfish ###  \n  # Logistic Regression Model\n  log.mod.copper.prop <- glm(cbind(mort.data$Days_Survived[mort.data$Species==\"Copper\"],\n                                   mort.data$DaysDead[mort.data$Species==\"Copper\"])\n                              ~Treatment_Temperature, \n                             family = binomial(link = 'logit'), \n                              data = mort.data[mort.data$Species == \"Copper\",])\n  summary(log.mod.copper.prop)\n\n### Quillback Rockfish ###\n  log.mod.quill.prop <- glm(cbind(mort.data$Days_Survived[mort.data$Species==\"Quillback\"],\n                                  mort.data$DaysDead[mort.data$Species==\"Quillback\"])\n                              ~Treatment_Temperature, family = binomial(link = 'logit'), \n                              data = mort.data[mort.data$Species==\"Quillback\",])\n  summary(log.mod.quill.prop)\n  \n```\n\n##Plotting\n# Proportion days survived across temperature - Complex level\n# (4 panel plot)\n```{r}\n###################################################\n#### Create Prediction for Logistic Regression ####\n###################################################\n\n  BY.pred <- predict(log.mod.all.complex, data.frame(Treatment_Temperature = 10:23, \n                                                     Species3 = \"BY\"), se.fit = TRUE)\n  CQ.pred <- predict(log.mod.all.complex, data.frame(Treatment_Temperature = 10:23, \n                                                     Species3 = \"CQ\"), se.fit = TRUE)\n  Quill.pred <- predict(quasiModel2, data.frame(Treatment_Temperature = 10:23, \n                                                Species2 = \"Quillback\"), se.fit = TRUE)\n  Copper.pred <- predict(quasiModel2, data.frame(Treatment_Temperature = 10:23, \n                                                     Species2 = \"Copper\"), se.fit = TRUE)\n\n##############\n#### Plot ####\n##############\n  \n# set the plotting window - 4 panels  \n  par(mfrow = c(2,2))\n  par(oma = c(4, 4, 1, 1))\n  par(mar = c(2, 2, 1, 1))\n  \n############################\n#### BY Complex Panel A ####\n############################\n  \n  plot(mort.data$PropDaysSurv[mort.data$Species == \"Black\"] ~\n       mort.data$Treatment_Temperature[mort.data$Species == \"Black\"], \n       xlim = c(10,23), col = \"black\", pch = 19, bty = \"l\", \n       ylim = c(0,1), xaxt = \"n\")\n  points(mort.data$PropDaysSurv[mort.data$Species == \"Yellowtail\"] ~ \n         mort.data$Treatment_Temperature[mort.data$Species == \"Yellowtail\"], \n          pch = 19, col = \"black\")\n  points(y=exp(BY.pred$fit)/(1+exp(BY.pred$fit)), x = 10:23,\n         type = \"l\")\n  points(y = exp(BY.pred$fit+1.96*BY.pred$se.fit)/\n           (1+exp(BY.pred$fit+1.96*BY.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  points(y = exp(BY.pred$fit-1.96*BY.pred$se.fit)/\n             (1+exp(BY.pred$fit-1.96*BY.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  legend(\"bottomleft\", legend = \"BY Complex\", pch = 19, \n         col = \"black\",  cex = 0.8)\n  mtext(text = \"A\", side = 3, adj = 0.01, padj = 0.01)\n  \n########################  \n#### Copper Panel C ####\n########################\n  \n  plot(PropDaysSurv[mort.data$Species==\"Copper\"]~\n         Treatment_Temperature[mort.data$Species==\"Copper\"], \n       data = mort.data, pch = 15, col = \"darkorange2\", yaxt = \"n\",\n       bty = \"l\", ylim = c(0,1), xlim = c(10,23), xaxt = \"n\")\n  points(y=exp(Copper.pred$fit)/(1+exp(Copper.pred$fit)), x = 10:23,\n         type = \"l\")\n  points(y = exp(Copper.pred$fit-1.96*(Copper.pred$se.fit))/\n              (1+exp(Copper.pred$fit-1.96*Copper.pred$se.fit)), \n         x = 10:23, type = \"l\", col = \"lightgrey\")\n  points(y = exp(Copper.pred$fit+1.96*(Copper.pred$se.fit))/\n              (1+exp(Copper.pred$fit+1.96*Copper.pred$se.fit)), \n         x = 10:23, type = \"l\", col = \"lightgrey\")\n  legend(\"bottomleft\", legend = \"Copper\", pch = 15, col = \"darkorange2\", cex = 0.8)\n  mtext(text = \"C\", side = 3, adj = 0.01, padj = 0.01)\n\n############################\n#### CQ complex Panel B ####\n############################\n  \n  plot(mort.data$PropDaysSurv[mort.data$Species == \"Copper\"] ~\n       mort.data$Treatment_Temperature[mort.data$Species == \"Copper\"], \n       col = \"orange\", xlim = c(10,23), xlab = \"\",\n       pch = 19, bty = \"l\", ylim = c(0,1), ylab = \"\")\n  points(mort.data$PropDaysSurv[mort.data$Species == \"Quillback\"] ~ \n         mort.data$Treatment_Temperature[mort.data$Species == \"Quillback\"], \n         col = \"orange\", pch = 19)\n  points(y=exp(CQ.pred$fit)/(1+exp(CQ.pred$fit)), x = 10:23,\n         type = \"l\")\n  points(y = exp(CQ.pred$fit+1.96*CQ.pred$se.fit)/\n           (1+exp(CQ.pred$fit+1.96*CQ.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  points(y = exp(CQ.pred$fit-1.96*CQ.pred$se.fit)/\n             (1+exp(CQ.pred$fit-1.96*CQ.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  legend(\"bottomleft\", legend = \"CQ Complex\", pch = 19, \n         col = \"orange\", cex = 0.8)\n  mtext(text = \"B\", side = 3, adj = 0.01, padj = 0.01)\n\n###########################\n#### Quillback Panel D ####\n###########################\n  \n  plot(PropDaysSurv[mort.data$Species==\"Quillback\"]~\n         Treatment_Temperature[mort.data$Species==\"Quillback\"], \n       data = mort.data, pch = 17, col = \"brown\", yaxt = \"n\",\n       bty = \"l\", ylim = c(0,1), xlim = c(10,23), xlab = \"\", ylab = \"\")\n  legend(\"bottomleft\", legend = \"Quillback\", pch = 17, col = \"brown\", cex = 0.8)\n  points(y=exp(Quill.pred$fit)/(1+exp(Quill.pred$fit)), x = 10:23, type = \"l\")\n  points(y = exp(Quill.pred$fit+1.96*Quill.pred$se.fit)/\n           (1+exp(Quill.pred$fit+1.96*Quill.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  points(y = exp(Quill.pred$fit-1.96*Quill.pred$se.fit)/\n             (1+exp(Quill.pred$fit-1.96*Quill.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  #points(y=qb.y, x = 10:23, type = \"l\")\n  mtext(text = \"D\", side = 3, adj = 0.01, padj = 0.01)\n  mtext(\"Proportion of Days Survived\", side = 2, outer = TRUE, cex = 1, line = 2.2)\n  mtext(expression(paste('Treatment Temperature (',degree,'C)',sep='')), side = 1, \n        outer = TRUE, cex = 1, line = 2.2)\n```\n## Proportion of Days Survived Against Temperature with Bar Graph of Predictions at 3 Temperatures (4 panels) (NOT USING)\n```{r}\n# set the plotting window - 4 panels  \n  par(mfrow = c(2,2))\n  par(oma = c(4, 4, 1, 1))\n  par(mar = c(2, 2, 1, 1))\n  \n###### Panel 1 ###### \n## Copper Rockfish ##\n#####################\n  plot(PropDaysSurv[mort.data$Species==\"Copper\"]~Treatment_Temperature[mort.data$Species==\"Copper\"], \n       data = mort.data, pch = 19, col = \"orange\",\n       xlab = \"\", ylab = \"\", bty = \"l\", xaxt = \"n\", ylim = c(0,1), xlim = c(10,23))\n\n # Create Prediction for Fitting Data and Standard Error\n  cop.prop.daysurv.pred <- predict(log.mod.copper.prop, \n                                   data.frame(Treatment_Temperature = 10:23), \n                                   se.fit = TRUE)\n  points(y=exp(cop.prop.daysurv.pred$fit)/(1+exp(cop.prop.daysurv.pred$fit)), x = 10:23,\n         type = \"l\")\n  points(y = exp(cop.prop.daysurv.pred$fit+1.96*cop.prop.daysurv.pred$se.fit)/\n           (1+exp(cop.prop.daysurv.pred$fit+1.96*cop.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  points(y = exp(cop.prop.daysurv.pred$fit-1.96*cop.prop.daysurv.pred$se.fit)/\n             (1+exp(cop.prop.daysurv.pred$fit-1.96*cop.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  text(14, 0.07, label = \"slope = -0.27 +/- 0.06\")\n # text(14, 0.03, label = \"p < 0.001***\")\n  legend(19.5, 0.15, legend = \"Copper\", pch = 19, col = \"orange\", cex = 0.8)\n  mtext(text = \"A\", side = 3, adj = 0.01, padj = 0.01)\n\n########### Panel 2 ###########\n## Black/Yellowtail Rockfish ##\n###############################\n  plot(mort.data$PropDaysSurv[mort.data$Species==\"Black\"]~Treatment_Temperature[mort.data$Species==\"Black\"], \n       data = mort.data, pch = 18, col = \"black\",\n       xlab = \"\", ylab = \"\", bty = \"l\", yaxt = \"n\", xlim = c(10,23), ylim = c(0,1))\n  points(mort.data$PropDaysSurv[mort.data$Species==\"Yellowtail\"]~\n         Treatment_Temperature[mort.data$Species==\"Yellowtail\"], \n         data = mort.data, pch = 22, bg = \"goldenrod\", col = \"black\")\n  \n # Create Prediction for Fitting Data and Standard Error\n  blkyt.prop.daysurv.pred <- predict(log.mod.blkyt.prop, \n                                   data.frame(Treatment_Temperature = 10:23), \n                                   se.fit = TRUE)\n  points(y=exp(blkyt.prop.daysurv.pred$fit)/(1+exp(blkyt.prop.daysurv.pred$fit)), \n         x = 10:23, type = \"l\")\n  points(y = exp(blkyt.prop.daysurv.pred$fit+1.96*blkyt.prop.daysurv.pred$se.fit)/\n           (1+exp(blkyt.prop.daysurv.pred$fit+1.96*blkyt.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"darkgrey\")\n  points(y = exp(blkyt.prop.daysurv.pred$fit-1.96*blkyt.prop.daysurv.pred$se.fit)/\n             (1+exp(blkyt.prop.daysurv.pred$fit-1.96*blkyt.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"darkgrey\")\n  text(14, 0.07, label = \"slope = -1.22 +/- 0.29\")\n#  text(14, 0.03, label = \"p < 0.001***\")\n  legend(19.5, 0.2, legend = c(\"Black\", \"Yellowtail\"), pch = c(18, 22), \n         pt.bg = c(\"black\", \"goldenrod\"), col = c(\"black\", \"black\"), \n         cex = 0.8)\n  mtext(text = \"B\", side = 3, adj = 0.01, padj = 0.01)\n\n  \n####### Panel 3 ########\n## Quillback Rockfish ##\n########################\n  \n  plot(mort.data$PropDaysSurv[mort.data$Species==\"Quillback\"]~Treatment_Temperature, \n       data = mort.data[mort.data$Species==\"Quillback\",], pch = 17, col = \"brown\",\n       xlab = \"Temperature\", ylab = \"Proportion of Days Survived\", bty = \"l\", ylim = c(0,1), xlim = c(10,23))\n  \n  # Create Prediction for Fitting Data and Standard Error\n  quill.prop.daysurv.pred <- predict(log.mod.quill.prop, \n                                   data.frame(Treatment_Temperature = 10:23), \n                                   se.fit = TRUE)\n  points(y=exp(quill.prop.daysurv.pred$fit)/(1+exp(quill.prop.daysurv.pred$fit)), x = 10:23, type = \"l\")\n  points(y = exp(quill.prop.daysurv.pred$fit+1.96*quill.prop.daysurv.pred$se.fit)/\n           (1+exp(quill.prop.daysurv.pred$fit+1.96*quill.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  points(y = exp(quill.prop.daysurv.pred$fit-1.96*quill.prop.daysurv.pred$se.fit)/\n             (1+exp(quill.prop.daysurv.pred$fit-1.96*quill.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  text(14, 0.07, label = \"slope = -0.18 +/- 0.04\")\n#  text(14, 0.03, label = \"p < 0.001***\")\n  legend(19.5, 0.15, legend = \"Quillback\", pch = 17, col = \"brown\", cex = 0.8)\n  mtext(text = \"C\", side = 3, adj = 0.01, padj = 0.01)\n\n  mtext(\"Temperature\", side = 1, outer = TRUE, cex = 1, line = 2.2)\n  mtext(\"Proportion of Days Survived\", side = 2, outer = TRUE, cex = 1, line = 2.2)\n  \n\n### Panel 4 ### \n## Bar Graph ##\n###############\n\n# Copper rockfish\n  cp.fit <- as.data.frame(exp(cop.prop.daysurv.pred$fit)/(1+exp(cop.prop.daysurv.pred$fit)))\n  cp.up.CI <- as.data.frame(exp(cop.prop.daysurv.pred$fit+1.96*cop.prop.daysurv.pred$se.fit)/\n             (1+exp(cop.prop.daysurv.pred$fit+1.96*cop.prop.daysurv.pred$se.fit))) \n  cp.low.CI <- as.data.frame(exp(cop.prop.daysurv.pred$fit-1.96*cop.prop.daysurv.pred$se.fit)/\n               (1+exp(cop.prop.daysurv.pred$fit-1.96*cop.prop.daysurv.pred$se.fit)))\n  cp.logistic.data <- cbind(cp.fit, cp.up.CI, cp.low.CI)\n  colnames(cp.logistic.data) <- c(\"cp.log.fit\", \"cp.up.CI\", \"cp.low.CI\")\n\n# Quillback rockfish\n  qb.fit <- as.data.frame(exp(quill.prop.daysurv.pred$fit)/(1+exp(quill.prop.daysurv.pred$fit)))\n  qb.up.CI <- as.data.frame(exp(quill.prop.daysurv.pred$fit+1.96*quill.prop.daysurv.pred$se.fit)/\n             (1+exp(quill.prop.daysurv.pred$fit+1.96*quill.prop.daysurv.pred$se.fit)))\n  qb.low.CI <- as.data.frame(exp(quill.prop.daysurv.pred$fit-1.96*quill.prop.daysurv.pred$se.fit)/\n               (1+exp(quill.prop.daysurv.pred$fit-1.96*quill.prop.daysurv.pred$se.fit)))\n  qb.logistic.data <- cbind(qb.fit, qb.up.CI, qb.low.CI)\n  colnames(qb.logistic.data) <- c(\"qb.log.fit\", \"qb.up.CI\", \"qb.low.CI\")\n\n# Black & Yellowtail rockfish\n  blkyt.fit <- as.data.frame(exp(blkyt.prop.daysurv.pred$fit)/(1+exp(blkyt.prop.daysurv.pred$fit)))\n  blkyt.up.CI <- as.data.frame(exp(blkyt.prop.daysurv.pred$fit+1.96*blkyt.prop.daysurv.pred$se.fit)/\n             (1+exp(blkyt.prop.daysurv.pred$fit+1.96*blkyt.prop.daysurv.pred$se.fit)))\n  blkyt.low.CI <- as.data.frame(exp(blkyt.prop.daysurv.pred$fit-1.96*blkyt.prop.daysurv.pred$se.fit)/\n               (1+exp(blkyt.prop.daysurv.pred$fit-1.96*blkyt.prop.daysurv.pred$se.fit)))\n  blkyt.logistic.data <- cbind(blkyt.fit, blkyt.up.CI, blkyt.low.CI)\n  colnames(blkyt.logistic.data) <- c(\"blkyt.log.fit\", \"blkyt.up.CI\", \"blkyt.low.CI\")\n  logistic.CI.data <- cbind(cp.logistic.data,qb.logistic.data, blkyt.logistic.data)\n  rownames(logistic.CI.data) <- c(10:23)\n\n# Create Data Frame for Bar Graph\n  cpfit <- cbind(logistic.CI.data$cp.log.fit[c(5,10,13)])\n  qbfit <- cbind(logistic.CI.data$qb.log.fit[c(5,10,13)])\n  blkytfit <- cbind(logistic.CI.data$blkyt.log.fit[c(5,10,13)])\n  log.fits <- t(cbind(blkytfit, cpfit, qbfit))\n  \n# Create Data Frame for upper CI\n  cpup <- cbind(logistic.CI.data$cp.up.CI[c(5,10,13)])\n  qbup <- cbind(logistic.CI.data$qb.up.CI[c(5,10,13)])\n  blkytup <- cbind(logistic.CI.data$blkyt.up.CI[c(5,10,13)])\n  up.CI <- t(cbind(blkytup, cpup, qbup))\n\n# Create Data Frame for lower CI  \n  cplow <- cbind(logistic.CI.data$cp.low.CI[c(5,10,13)])\n  qblow <- cbind(logistic.CI.data$qb.low.CI[c(5,10,13)])\n  blkytlow <- cbind(logistic.CI.data$blkyt.low.CI[c(5,10,13)])\n  low.CI <- t(cbind(blkytlow, cplow, qblow))\n  \n# Create barplot of \n  par(lwd = 2)\n  bp <- barplot(log.fits, beside = T, names = c(\"14°C\", \"19°C\", \"22°C\"), \n                col = c(\"black\",\"orange\", \"brown\"), border = c(\"goldenrod\", NA, NA),\n                ylim = c(0,1.12), ylab = \"Proportion of Days Survived\")\n  par(lwd = 1)\n  legend(\"topright\", legend = c(\"Black & Yellowtail\", \"Copper\", \"Quillback\"), \n         fill = c(\"black\", \"orange\", \"brown\"), border = c(\"goldenrod\", NA, NA),\n         cex = 0.55)\n  arrows(x0 = bp, x1 = bp, y0 = low.CI, y1 = up.CI, angle = 90, len = 0.1, code = 3, xpd = NA, \n         col = \"darkgrey\")\n  mtext(text = \"D\", side = 3, adj = 0.01, padj = 0.8)\n\n```\n\n## Proportion of Days Survived Against Temperature (3 Panels) (NOT USING)\n\n```{r}\npar(mfrow = c(3,1))\npar(oma = c(4, 4, 1, 1))\npar(mar = c(2, 2, 2, 1))\n\n\n## Figure out how to plot the intercept but no difference in slope\n###### Panel 1 ###### \n### Black Rockfish ##\n#####################\n\nplot(mort.data$PropDaysSurv[mort.data$Species==\"Black\"]~\n       Treatment_Temperature[mort.data$Species==\"Black\"], \n       data = mort.data, pch = 18, col = \"black\",\n       xlab = \"\", ylab = \"\", bty = \"l\", xlim = c(10,23), ylim = c(0,1))\npoints(mort.data$PropDaysSurv[mort.data$Species==\"Yellowtail\"]~\n         Treatment_Temperature[mort.data$Species==\"Yellowtail\"], \n         data = mort.data, pch = 22, bg = \"goldenrod\", col = \"black\")\nby.y <- 1/(1 + exp(-(28.96857 + (-.27062)*(10:23))))\npoints(y=by.y, x = 10:23, type = \"l\")\n# points(y = exp(BY.pred$fit+1.96*BY.pred$se.fit)/\n#            (1+exp(BY.pred$fit+1.96*BY.pred$se.fit)), \n#            x = 10:23, type = \"l\", col = \"lightgrey\")\n# points(y = exp(BY.pred$fit-1.96*BY.pred$se.fit)/\n#              (1+exp(BY.pred$fit-1.96*BY.pred$se.fit)), \n#            x = 10:23, type = \"l\", col = \"lightgrey\")\nlegend(\"bottomleft\", legend = c(\"Black\", \"Yellowtail\"), pch = c(18, 22), \n         pt.bg = c(\"black\", \"goldenrod\"), col = c(\"black\", \"black\"), \n         cex = 0.8)\nmtext(text = \"A\", side = 3, adj = 0.01, padj = 0.001)\n\n###### Panel 2 ###### \n## Copper Rockfish ##\n#####################\n\nplot(PropDaysSurv[mort.data$Species==\"Copper\"]~\n       Treatment_Temperature[mort.data$Species==\"Copper\"], \n       data = mort.data, pch = 19, col = \"orange\",\n       xlab = \"\", ylab = \"Proportion of Days Survived\", bty = \"l\", ylim = c(0,1), xlim = c(10,23))\nlegend(\"bottomleft\", legend = \"Copper\", pch = 19, col = \"orange\", cex = 0.8)\ncp.y <- 1/(1 + exp(-(7.3666 + (-.27062)*(10:23))))\npoints(y=cp.y, x = 10:23, type = \"l\")\n#cp.y2 <- 1/(1 + exp(-(6.5 + (-.27062)*(10:23))))\n#points(y=cp.y2, x = 10:200, type = \"l\")\npoints(y = exp(Copper.pred$fit+1.96*Copper.pred$se.fit)/\n            (1+exp(Copper.pred$fit+1.96*Copper.pred$se.fit)), \n            x = 10:23, type = \"l\", col = \"lightgrey\")\npoints(y = exp(Copper.pred$fit-1.96*Copper.pred$se.fit)/\n              (1+exp(Copper.pred$fit-1.96*Copper.pred$se.fit)), \n            x = 10:23, type = \"l\", col = \"lightgrey\")\nmtext(text = \"B\", side = 3, adj = 0.01, padj = 0.01)\n\n####### Panel 3 ########\n## Quillback Rockfish ##\n########################\n\nplot(mort.data$PropDaysSurv[mort.data$Species==\"Quillback\"]~\n       Treatment_Temperature[mort.data$Species==\"Quillback\"], \n       data = mort.data, pch = 17, col = \"brown\",\n       xlab = \"Temperature\", ylab = \"\", bty = \"l\", ylim = c(0,1), xlim = c(10,23))\nlegend(\"bottomleft\", legend = \"Quillback\", pch = 17, col = \"brown\", cex = 0.8)\nqb.y <- 1/(1 + exp(-(3.94364 + (-.27062)*(10:23))))\npoints(y=qb.y, x = 10:23, type = \"l\")\npoints(y=exp(Quill.pred$fit)/(1+exp(Quill.pred$fit)), x = 10:23, type = \"l\")\npoints(y = exp(Quill.pred$fit+1.96*Quill.pred$se.fit)/\n           (1+exp(Quill.pred$fit+1.96*Quill.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\npoints(y = exp(Quill.pred$fit-1.96*Quill.pred$se.fit)/\n             (1+exp(Quill.pred$fit-1.96*Quill.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\nmtext(text = \"C\", side = 3, adj = 0.01, padj = 0.01)\nmtext(\"Proportion of Days Survived\", side = 2, outer = TRUE, cex = 1, line = 2.2)\nmtext(expression(paste('Treatment Temperature (',~degree,'C)',sep='')), side = 1, outer = TRUE, cex = 1, line = 2.2)\n```\n\n### Do bucket average days survived\n```{r}\nave.days.surv <- aggregate(Days_Survived~Treatment_Temperature+Species3+Species2, data = mort.data, FUN = mean)\nave.days.dead <- aggregate(DaysDead~Treatment_Temperature+Species3+Species2, data = mort.data, FUN = mean)\nave.mort.data <- cbind(ave.days.surv, ave.days.dead$DaysDead)\ncolnames(ave.mort.data)[5] <- \"DaysDead\"\n\nave.quasi1 <- glm(cbind(Days_Survived, DaysDead)~Treatment_Temperature*Species3,\n                           family = quasibinomial(link = 'logit'), data = ave.mort.data)\nAnova(ave.quasi1, type = 2)\nsummary(ave.quasi1)\nave.quasi2 <- glm(cbind(Days_Survived, DaysDead)~Treatment_Temperature*Species2,\n                           family = quasibinomial(link = 'logit'), data = ave.mort.data)\nAnova(ave.quasi2, type = 2)\n```",
    "created" : 1520447238600.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "317|6|469|0|\n473|6|546|0|\n",
    "hash" : "4233223221",
    "id" : "E7EF055F",
    "lastKnownWriteTime" : 1557411332,
    "last_content_update" : 1558102869915,
    "path" : "~/Documents/Northeastern/LotterhosLab/Research/Field_Work/2015/TPC_Experiment/Analysis/Mortality_Data_FinalCode.Rmd",
    "project_path" : "Mortality_Data_FinalCode.Rmd",
    "properties" : {
        "chunk_output_type" : "console",
        "tempName" : "Untitled1"
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}