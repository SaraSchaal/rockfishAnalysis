{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Field Temp Data\"\nauthor: \"Sara Michele Schaal\"\ndate: \"3/15/2018\"\noutput: html_document\n---\n\n```{r, warning = FALSE}\nknitr::opts_knit$set(root.dir = \"/Users/saraschaal/Documents/Northeastern/LotterhosLab/Research/Field Work/2015/TPC_Experiment/Analysis\")\n```\n\n#Aphrodite Point Data\n##Monthly Average SST\n```{r}\n# Load Libraries\n  library(ggplot2)\n  library(scales)\n  library(dplyr)\n\n# Read in data and Manipulate Data\n  aphmonthSST <- read.csv(  \"./data/2004_2011MonthSSTAphroditePoint.csv\")\n  aphmonthSST.long <- reshape(aphmonthSST, varying = list(2:13), idvar = \"year\", direction = \"long\")\n  colnames(aphmonthSST.long) <- c(\"year\", \"month\", \"SST\")\n\n# Plot Monthly Averages\n  aphmonthSSTplot <- ggplot(data=aphmonthSST.long, \n                           aes(x=month, y=SST, \n                              group=as.factor(year), \n                              color = as.integer(year)))  +\n                   geom_point() + \n                   geom_smooth(method = \"loess\", se = FALSE) \n  aphmonthSSTplot + labs(y = \"Monthly Average SST\", x = \"Month\") + ggtitle(\"Aphrodite Point\") \n\n# box plot of Monthly Average SST at Aphrodite Point\n  boxplot(SST~year, data = aphmonthSST.long, ylim = c(6,15), \n          ylab = \"Monthly Mean SST\", xlab = \"Year\")\n  \n# Extract recruitment months\n  recruitmonths <- aphmonthSST.long[aphmonthSST.long$month == 5 | \n                                    aphmonthSST.long$month == 6 | \n                                    aphmonthSST.long$month == 7 | \n                                    aphmonthSST.long$month == 8, ]\n  recruitmonths <- subset(recruitmonths, subset = recruitmonths$year > 2003 & recruitmonths$year < 2016)\n# boxplot recruitment months\n  boxplot(SST~year, data = recruitmonths, \n          ylab = \"Monthly Mean SST\", xlab = \"Year\")\n  \n  \n```\n\n\n##Monthly Max?\n```{r}\n# Input data\n  aphdailySST <- read.csv(\"./data/AmphitriteDailySalTemp.csv\")\n\n# Manipulate Data\n  aphdaily2004 <- subset(aphdailySST, subset = aphdailySST$Year > 2003 & aphdailySST$Year < 2016)\n  aphdaily2004 <- aphdaily2004[aphdaily2004$Temperature < 99.9,]\n  aphdaily2004$MonthDay <- paste(aphdaily2004$Month, aphdaily2004$Day)\n  aphdaily2004$YMD <- paste(aphdaily2004$Year, aphdaily2004$Month, aphdaily2004$Day)\n  aphdaily2004$Date <- as.Date(aphdaily2004$YMD, \"%Y %m %d\")\n\n# Set standard error function\n  SE <- function(x){\n    sd(x)/sqrt(length(x))\n  }\n  \n# Get monthly max temperature\n  month.max <- aggregate(Temperature ~ Year + Month, data = aphdaily2004, FUN = max)\n  month.max$YearMonth <- paste(month.max$Year, month.max$Month, \"01\", sep = \"-\")\n  month.max$Date <- as.Date(month.max$YearMonth, \"%Y-%m-%d\")\n  month.max <- month.max[order(month.max$Date),]\n\n# Get monthly mean with CIs  \n  month.mean <- aggregate(Temperature ~ Year + Month, data = aphdaily2004, FUN = mean)\n  month.mean$YearMonth <- paste(month.mean$Year, month.mean$Month, \"01\", sep = \"-\")\n  month.mean$Date <- as.Date(month.mean$YearMonth, \"%Y-%m-%d\")\n  month.mean <- month.mean[order(month.mean$Date),]\n  \n  month.mean$SE <- aggregate(Temperature ~ Year + Month, data = aphdaily2004, FUN = SE)\n  month.mean$upr <- month.mean$SE + month.mean$Temperature\n  month.mean$low <- month.mean$Temperature - month.mean$SE\n  \n# Plot Monthly Max\n  aphdailySSTplot <- ggplot(data=month.max, \n                         aes(x=Month, y=Temperature, \n                            group=as.factor(Year), \n                            color = as.integer(Year)))  +\n                 geom_point() + \n                 geom_smooth(method = \"loess\", se = FALSE) \n                 \naphdailySSTplot + labs(y = \"Daily SST\", x = \"Day\") + ggtitle(\"Aphrodite Point\") \n\n\ndev.off()\n# boxplot\nboxplot(Temperature~Year, data = month.max, \n        ylab = \"Monthly Max SST\", xlab = \"Year\")\n\n\nrecruitmonths.daily <- month.max[month.max$Month == 5 |\n                           month.max$Month == 6 | \n                           month.max$Month == 7,]\nboxplot(Temperature~Year, data = recruitmonths.daily, \n        ylab = \"Monthly Max SST\", xlab = \"Year\")\nplot(Temperature~Date, data = aphdaily2004, type = \"l\")\n```\n\n#two panel plot\n```{r}\npar(mfrow = c(1,2))\n\nboxplot(SST~year, data = recruitmonths, \n          ylab = \"Monthly Mean SST\", xlab = \"Year\")\n\nboxplot(Temperature~Year, data = recruitmonths.daily, \n        ylab = \"Monthly Max SST\", xlab = \"Year\")\nmtext(\"Aphrodite Point Mean and Max Monthly SST/n for Recruitment Months (May, June & July)\", side = 3, outer = TRUE, cex = 1.3)\n\npar(mfrow = c(1,2))\nplot(Temperature~Date, data = month.max, ylim = c(7, 17), type = \"l\", main = \"Monthly Max Temperature\")\nplot(Temperature~Date, data = month.mean, type = \"l\", ylim = c(7,17), main = \"Monthly Mean Temperature\")\n\n```\n\n\n##Katie's Data\n### six sampling sites\n```{r}\n## Import data\n  tempSampSitesOrg <- read.csv(\"./data/TempData_site_Species.csv\")\n\n## Subsetting \n  # for columns of interest\n  tempSampSitesOrg <- subset(tempSampSitesOrg, select = c(ActualDate, Site, Temperature))\n  # Subset for only those values over 0 (zeros added when temperatures weren't taken)\n  tempSampSitesNoZeros <- tempSampSitesOrg[tempSampSitesOrg$Temperature > 0,]\n  # Remove rows with any NAs\n  tempSampSites <- na.omit(tempSampSitesNoZeros)\n   \n## Data manipulation \n  # Convert date column to date format and extract year for new column\n  tempSampSites$Date <- as.Date(tempSampSites$ActualDate, \"%m/%d/%Y\")\n  tempSampSites$Year <- substring(as.character(tempSampSites$Date),1,4)\n  tempSampSites$Month <- as.numeric(substring(as.character(tempSampSites$Date),6,7))\n  \n  # Convert number months to names\n  tempSampSites$MonthName <- NA\n  for(i in 1:nrow(tempSampSites)){\n    if(tempSampSites$Month[i] == 6){\n      tempSampSites$MonthName[i] <- \"June\"\n    } else if(tempSampSites$Month[i] == 7){\n      tempSampSites$MonthName[i] <- \"July\"\n    } else if(tempSampSites$Month[i] == 8){\n      tempSampSites$MonthName[i] <- \"August\"\n    } else if(tempSampSites$Month[i] == 5){\n      tempSampSites$MonthName[i] <- \"May\"\n    } else {\n      tempSampSites$MonthName[i] <- NA\n    }\n  }\n  \n  # Convert data into the same scale some years Fahrenheit was taken others Celcius\n  for(i in 1:nrow(tempSampSites)){\n    if(tempSampSites$Temperature[i] > 40){\n      tempSampSites$Temperature[i] <- (tempSampSites$Temperature[i]-32)*(5/9)\n    } else {\n      tempSampSites$Temperature[i] <- tempSampSites$Temperature[i]\n    }\n  } \n  \n  # Subset the data for only sites I sampled\n  tempSampSixSites <- tempSampSites[tempSampSites$Site == \"Bluestone\" |\n                                         tempSampSites$Site == \"Blowhole\" |\n                                         tempSampSites$Site == \"Execution\" |\n                                         tempSampSites$Site == \"Nudibranch\" |\n                                         tempSampSites$Site == \"Prasiola\", ]\n# Set standard error function\n  SE <- function(x){\n    sd(x)/sqrt(length(x))\n  }\n  \n  meanTempKaties <- aggregate(Temperature~Month+Year, data = tempSampSixSites, FUN = mean)\n  confidMeanTempKaties <- aggregate(Temperature~Month+Year, data = tempSampSixSites, FUN = SE)\n  meanTempKaties$upp <- meanTempKaties$Temperature + 1.96*confidMeanTempKaties$Temperature\n  meanTempKaties$lowr <- meanTempKaties$Temperature - 1.96*confidMeanTempKaties$Temperature\n  maxTempKaties <- aggregate(Temperature~Date, data = tempSampSixSites, FUN = max)\n  \n## Plotting\n\n  par(mfrow = c(2,2))\n  par(oma = c(4, 4, 2, 1))\n  par(mar = c(2, 2, 1, 1))\n  tempSampSixSites$Year <- as.factor(tempSampSixSites$Year)\n  boxplot(Temperature~Year, data = tempSampSixSites[tempSampSixSites$Month == 5,], \n          ylim = c(10, 21))\n  text(1, 20, label = \"May\", cex = 1.5)\n  boxplot(Temperature~Year, data = tempSampSixSites[tempSampSixSites$Month == 6,], \n          ylim = c(10, 21))\n  text(1.1, 20, label = \"June\", cex = 1.5)\n  boxplot(Temperature~Year, data = tempSampSixSites[tempSampSixSites$Month == 7,], \n          ylim = c(10, 21))\n  text(1.1, 20, label = \"July\", cex = 1.5)\n  boxplot(Temperature~Year, data = tempSampSixSites[tempSampSixSites$Month == 8,],\n          ylim = c(10, 21))\n  text(1.4, 20, label = \"August\", cex = 1.5)\n  mtext(\"Year\", side = 1, outer = TRUE, cex = 1.2, line = 2.2)\n  mtext(\"Temperature\", side = 2, outer = TRUE, cex = 1.2, line = 2.2)\n  mtext(\"Data from 6 Sampling Sites\", side = 3, outer = TRUE, cex = 1.4)\n  \n# Mean of recruitment months\n  boxplot(Temperature~Year, data = tempSampSixSites, ylim = c(10,21))\n  zeros.data <- data.frame(ActualDate = c(2004, 2005, 2011, 2012, 2013), Site = \"Blowhole\", \n             Temperature = NA, Date = c(2004-06-08, 2005-06-08, 2011-06-08, 2012-06-08, 2013-06-08),\n             Year = c(2004, 2005, 2011, 2012, 2013), Month = 6, MonthName = \"June\", stringsAsFactors = FALSE)\n  tempSampSixSites$ActualDate <- as.character(tempSampSixSites$ActualDate)\n  tempSampSixSites$Date <- as.character(tempSampSixSites$Date)\n  tempSampSixSites$Year <- as.numeric(as.character(tempSampSixSites$Year))\n  tempSampSixSitesAll <- rbind(tempSampSixSites, zeros.data)\n  tempSampSixSitesAll$Year <- as.factor(tempSampSixSitesAll$Year)\n  \n  boxplot(Temperature~Year, data = tempSampSixSitesAll)\n\n```\n\n\n```{r}\n\n#########################################\n#### Two Panel AphPoint & Samp Sites ####\n#########################################\npar(mfrow = c(1,2))\nboxplot(SST~year, data = recruitmonths, \n          ylab = expression(paste('Mean SST (',degree,'C)',sep='')), xlab = \"Year\", col = \"cornflowerblue\",\n        ylim = c(10,20))\nboxplot(Temperature~Year, data = tempSampSixSitesAll, col = \"aquamarine\",\n        ylab = \"\", ylim = c(10, 20))\n\n#####################\n#### Single Plot ####\n#####################\nsites.df <- tempSampSixSitesAll[,c(3,5,6)]\naph.df <- recruitmonths[,c(1:3)]\nsites.df$location <- \"SampSites\"\naph.df$location <- \"Aphrodite Point\"\ncolnames(sites.df) <- c(\"SST\", \"year\", \"month\")\ndf.locs <- rbind(sites.df, aph.df)\ndf.locs <- na.omit(df.locs, cols = year)\npar(mfrow = c(1,1))\nboxplot(SST~location+year, data = df.locs, at = c(1:2, 4:5, 7:8, 10:11, 13:14, 16:17, 19:20, 22:23, 25:26, 28:29, 31:32, 34:35), col = c(\"cornflowerblue\", \"aquamarine\" ), names = c(\"      2004\", \"\", \"     2005\", \"\", \"      2006\", \"\", \"      2007\", \"\", \"      2008\", \"\", \"      2009\", \"\", \"      2010\", \"\", \"       2011\", \"\", \"      2012\", \"\", \"      2013\", \"\", \"      2014\", \"\", \"      2015\", \"\"), ylab = expression(paste('Temperature (',degree,'C)',sep='')), xlab = \"Year\")\nlegend(\"topleft\", legend = c(\"Aphrodite Point\", \"Six Sampling Locations\"), fill = c(\"cornflowerblue\", \"aquamarine\"), cex = 0.8)\n\n\n```",
    "created" : 1523027337512.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3208871538",
    "id" : "EE711BC0",
    "lastKnownWriteTime" : 1557755946,
    "last_content_update" : 1557755946470,
    "path" : "~/Documents/Northeastern/LotterhosLab/Research/Field_Work/2015/TPC_Experiment/Analysis/FieldTempData.Rmd",
    "project_path" : "FieldTempData.Rmd",
    "properties" : {
        "chunk_output_type" : "console",
        "tempName" : "Untitled2"
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}