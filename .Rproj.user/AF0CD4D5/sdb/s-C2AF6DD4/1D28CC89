{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Mortality Data\"\nauthor: \"Sara Michele Schaal\"\ndate: \"June 28, 2016\"\noutput: pdf_document\n---\n\n## Mortality Data Analysis\n\n### Data Loading and Manipulation\n\n```{r}\n\nmort.data <- read.csv(\"/Users/saraschaal/Documents/Northeastern/LotterhosLab/Research/Field Work/2015/TPC_Experiment/Analysis/data/Mortality.csv\")\nmort.data$Treatment_Temperature <- round(mort.data$Treatment_Temperature, digits = 1)\n\nblack.mort.data <- subset(mort.data, mort.data$Species == c(\"Black\", \"Yellowtail\"))\ncopper.mort.data <- subset(mort.data, mort.data$Species == c(\"Copper\", \"Quillback\"))\n\nmort.black3 <- which(mort.data$Species == c(\"Black\", \"Yellowtail\"))\nmort.copper3 <- which(mort.data$Species == c(\"Copper\", \"Quillback\"))\n\nmort.black <- which(mort.data$Species == \"Black\")\nmort.black2 <- tapply(mort.data$Days_Survived[mort.black], mort.data$Treatment_Temperature[mort.black],mean)\ndf.mort.black <- data.frame(temp=names(mort.black2), mort.black2)\n\nmort.copper <- which(mort.data$Species == \"Copper\")\nmort.copper2 <- tapply(mort.data$Days_Survived[mort.copper], mort.data$Treatment_Temperature[mort.copper],mean)\ndf.mort.copper <- data.frame(temp=names(mort.copper2), mort.copper2)\n\nmort.quillback <- which(mort.data$Species == \"Quillback\")\nmort.yellowtail <- which(mort.data$Species == \"Yellowtail\")\nmort.hybrid <- which(mort.data$Species == \"Hybrid\")\nmort.bunknown <- which(mort.data$Species == \"x\")\nmort.cunknown <- which(mort.data$Species == \"\")\nmort.copquil <- which(mort.data$Species == \"Quillback\" | mort.data$Species == \"Copper\")\nmort.blkylt <- which(mort.data$Species == \"Black\" | mort.data$Species == \"Yellowtail\")\n```\n\n### Box plots - Days Survived by Temperature\n\n```{r}\nboxplot(mort.data$Days_Survived[mort.copper]~mort.data$Treatment_Temperature[mort.copper], \n        xlab = \"\", \n        ylab = \"\", ylim = c(1, 14),\n        main = \"Copper \", col = \"orange\")\nboxplot(mort.data$Days_Survived[mort.black]~mort.data$Treatment_Temperature[mort.black], \n        xlab = expression(paste(\"Temperature (\",degree,\"C)\")), \n        ylab = \"Days Survived\", ylim = c(1, 14), \n        main = \"Black\")\nboxplot(mort.data$Days_Survived[mort.yellowtail]~mort.data$Treatment_Temperature[mort.yellowtail],\n        at = c(1,3,4,5,6,9), names = c(\"10\", \"15\", \"18\", \"19\", \"20\", \"22\"),\n        xlab = expression(paste(\"Temperature (\",degree,\"C)\")), \n        ylab = \"Days Survived\", ylim = c(1, 14), \n        main = \"Yellowtail\", col = \"goldenrod\")\nboxplot(mort.data$Days_Survived[mort.hybrid]~mort.data$Treatment_Temperature[mort.hybrid], \n        xlab = expression(paste(\"Temperature Treatment (\",degree,\"C)\")), \n        ylab = \"Days Survived\", ylim = c(1, 14), \n        main = \"Black/Yellowtail Hybrid Mortality\")\nboxplot(mort.data$Days_Survived[mort.quillback]~mort.data$Treatment_Temperature[mort.quillback], \n        xlab = \"\", \n        ylab = \"\", ylim = c(1, 14), col = \"brown\", \n        main = \"Quillback\")\n#boxplot(mort.data$Days_Survived[mort.bunknown]~mort.data$Treatment_Temperature[mort.bunknown], \n #       xlab = expression(paste(\"Temperature Treatment (\",degree,\"C)\")), \n #       ylab = \"Days Survived\", ylim = c(1, 14), col = \"black\", \n #       main = \"Black Unknown Rockfish Mortality\")\nboxplot(mort.data$Days_Survived[mort.cunknown]~mort.data$Treatment_Temperature[mort.cunknown], \n        xlab = expression(paste(\"Temperature Treatment (\",degree,\"C)\")), \n        ylab = \"Days Survived\", ylim = c(1, 14), col = \"blue\", \n        main = \"Copper Unknown Rockfish Mortality\")\n\n```\n# Analysis\n## Linear Model\n### Black Rockfish Experiment \n\n#### Black and yellowtail rockfish together to determine if there is a significant species interaction\n\n```{r}\n\n# Analyzing black and yellowtail together\nmod1.mort.blkAyt <- lm(mort.data$Days_Survived[mort.black3]~mort.data$Treatment_Temperature[mort.black3]*mort.data$Species[mort.black3]+ mort.data$Weight[mort.black3])\nsummary(mod1.mort.blkAyt)\ndrop1(mod1.mort.blkAyt)\n#Best model is with species interaction ANALYZE SEPARATELY??\n\nmod2.mort.blkAyt <- lm(mort.data$Days_Survived[mort.black3]~mort.data$Treatment_Temperature[mort.black3] + mort.data$Species[mort.black3])\nsummary(mod2.mort.blkAyt)\ndrop1(mod2.mort.blkAyt)\n\n```\n\n#### Siginificant species interaction analyze separate\n\n#### Black and Yellowtail Analyses Separated\n\n```{r}\n\nmod1.blk.mort <- lm(mort.data$Days_Survived[mort.black]~mort.data$Treatment_Temperature[mort.black]+mort.data$Weight[mort.black])\nsummary(mod1.blk.mort)\ndrop1(mod1.blk.mort)\n\nmod1.yt.mort <- lm(mort.data$Days_Survived[mort.yellowtail]~mort.data$Treatment_Temperature[mort.yellowtail]+mort.data$Weight[mort.yellowtail])\nsummary(mod1.yt.mort)\ndrop1(mod1.yt.mort)\n\n```\n\n### Copper Rockfish Experiment\n\n#### Copper and Quillback Rockfish together to determine if there is a significant species interaction\n\n```{r}\nmod1.mort.cpAqb <- lm(mort.data$Days_Survived[mort.copper3]~mort.data$Treatment_Temperature[mort.copper3]*mort.data$Species[mort.copper3])\nsummary(mod1.mort.cpAqb)\ndrop1(mod1.mort.cpAqb)\n# Significant Species interaction ANALYZE SEPARATELY\n\nmod2.mort.cpAqb <- lm(mort.data$Days_Survived[mort.copper3]~mort.data$Treatment_Temperature[mort.copper3] + mort.data$Species[mort.copper3])\nsummary(mod2.mort.cpAqb)\n\n```\n\n#### Copper and Quillback Analyzed Separately\n\n```{r}\nmod1.cp.mort <- lm(mort.data$Days_Survived[mort.copper]~mort.data$Treatment_Temperature[mort.copper]+mort.data$Weight[mort.copper])\nsummary(mod1.cp.mort)\ndrop1(mod1.cp.mort)\n\n\nmod1.qb.mort <- lm(mort.data$Days_Survived[mort.quillback]~mort.data$Treatment_Temperature[mort.quillback]+mort.data$Weight[mort.quillback])\nsummary(mod1.qb.mort)\ndrop1(mod1.qb.mort)\n\nb <- 14\nm <- 0.2 # (optimize to find m)\nx <- 1:15\n\n\nz = -m*x^2 + b\ny = b-exp(m*x)\nplot(y~x)\nplot(z~x)\n\n# look up survival models. \n# test the model with all the species in one model.\n# check the climate models for vancouver area.\n# plot out size and mortality \n# 3d plot of temp/survival/size\n# tradeoff between growth and mortality? \n# rate with the ones that died \n# time scale of response if you just look at the growth change\n\n\n```\n\n\n### Plot as Two Experiments - Scatter with Jitter\n\n```{r}\n# Subset data for plotting\n  copper.mort <- subset(mort.data, mort.data$Species == \"Copper\")\n  black.mort <- subset(mort.data, mort.data$Species == \"Black\") \n  quillback.mort <- subset(mort.data, mort.data$Species == \"Quillback\")\n  yellowtail.mort <- subset(mort.data, mort.data$Species == \"Yellowtail\")\n\n# copper\n  plot(copper.mort$Days_Survived ~ jitter(copper.mort$Treatment_Temperature,1), col = \"orange\", \n       pch = 19, bty = \"l\", ylim = c(0,14), xlab = \"Temperature\", ylab = \"Days Survived\",\n       main = \"Copper and Quillback Survival\")\n  points(quillback.mort$Days_Survived ~ jitter(quillback.mort$Treatment_Temperature, 1), col = \"brown\",\n         pch = 19)\n  legend(\"bottomright\", legend = c(\"Copper\", \"Quillback\"), pch = c(19,19), col = c(\"orange\", \"brown\"))\n\n# black \n  plot(black.mort$Days_Survived ~ jitter(black.mort$Treatment_Temperature, 1), \n       col = \"black\", pch = 19, bty = \"l\", ylim = c(0,14), xlab = \"Temperature\", \n       ylab = \"Days Survived\", main = \"Black and Yellowtail Survival\")\n  points(yellowtail.mort$Days_Survived ~ jitter(yellowtail.mort$Treatment_Temperature, 1), \n         col = \"goldenrod\", pch = 19)\n  legend(\"bottomright\", legend = c(\"Black\", \"Yellowtail\"), pch = c(19,19), col = c(\"black\", \"goldenrod\"))\n```\n\n### Survival Proportions\n\n```{r}\n\n  # Calculate Survival Proportions\n    surv.prop.cp <- aggregate(copper.mort$Status, \n                              list(copper.mort$Treatment_Temperature), mean)\n    surv.count.cp <- aggregate(copper.mort$Status, \n                                     list(copper.mort$Treatment_Temperature), length)\n    surv.prop.cp <- cbind(surv.prop.cp, surv.count.cp[,2])\n    \n    surv.prop.blk <- aggregate(black.mort$Status, \n                               list(black.mort$Treatment_Temperature), mean)\n    surv.count.blk <- aggregate(black.mort$Status, \n                                     list(black.mort$Treatment_Temperature), length)\n    surv.prop.blk <- cbind(surv.prop.blk, surv.count.blk[,2])\n    \n    surv.prop.quill <- aggregate(quillback.mort$Status, \n                                 list(quillback.mort$Treatment_Temperature), mean)\n    surv.count.quill <- aggregate(quillback.mort$Status, \n                                     list(quillback.mort$Treatment_Temperature), length)\n    surv.prop.quill <- cbind(surv.prop.quill, surv.count.quill[,2])\n    \n    surv.prop.ytl <- aggregate(yellowtail.mort$Status, \n                               list(yellowtail.mort$Treatment_Temperature), mean)\n    surv.count.ytl <- aggregate(yellowtail.mort$Status, \n                                     list(yellowtail.mort$Treatment_Temperature), length)\n    surv.prop.ytl <- cbind(surv.prop.ytl, surv.count.ytl[,2])\n    \n  # Rename headers\n    colnames(surv.prop.cp) <- c(\"Temperature\", \"Surv.Prop\", \"Weight\")\n    colnames(surv.prop.blk) <- c(\"Temperature\", \"Surv.Prop\", \"Weight\")\n    colnames(surv.prop.quill) <- c(\"Temperature\", \"Surv.Prop\", \"Weight\")\n    colnames(surv.prop.ytl) <- c(\"Temperature\", \"Surv.Prop\", \"Weight\")\n    \n  # Logistic Regression of Proportion Data - Same as lived/died data?\n    log.mod.prop.cp <- glm(Surv.Prop~Temperature, weights = Weight,\n                           family = binomial(link = 'logit'), data = surv.prop.cp)\n    log.mod.prop.quill <- glm(Surv.Prop~Temperature, weights = Weight, \n                              family = binomial(link = 'logit'), data = surv.prop.quill)\n    log.mod.prop.blk <- glm(Surv.Prop~Temperature, weights = Weight, \n                            family = binomial(link = 'logit'), data = surv.prop.blk)\n    log.mod.prop.ytl <-  glm(Surv.Prop~Temperature, weights = Weight, \n                             family = binomial(link = 'logit'), data = surv.prop.ytl)\n\n  # Summary of Models\n    summary(log.mod.prop.cp)\n    summary(log.mod.prop.quill)\n    summary(log.mod.prop.blk)\n    summary(log.mod.prop.ytl)\n    \n  # Plot Survival Propotions - Separate Figures\n    dev.off()\n    par(mfrow = c(2,2))\n    plot(surv.prop.cp$Surv.Prop~surv.prop.cp$Temperature, pch = 19, bty = \"l\", col = \"orange\",\n         xlab = \"Temperature\", ylab = \"Survival Proportion\", \n         main = \"Copper Rockfish\")\n    curve(predict(surv.prop.cp, data.frame(Temperature = x), type = \"response\"), add = TRUE,\n          col = \"black\", lwd = 1)\n    plot(surv.prop.quill$Surv.Prop~surv.prop.quill$Temperature, pch = 19, bty = \"l\", col = \"brown\",\n         xlab = \"Temperature\", ylab = \"Survival Proportion\", \n         main = \"Quillback Rockfish\")\n    curve(predict(surv.prop.quill, data.frame(Temperature = x), type = \"response\"), add = TRUE,\n          col = \"black\", lwd = 1)\n    plot(surv.prop.blk$Surv.Prop~surv.prop.blk$Temperature, pch = 19, bty = \"l\", col = \"black\",\n         xlab = \"Temperature\", ylab = \"Survival Proportion\", \n         main = \"Black Rockfish\")\n    plot(surv.prop.ytl$Surv.Prop~surv.prop.ytl$Temperature, pch = 19, bty = \"l\", col = \"goldenrod\",\n         xlab = \"Temperature\", ylab = \"Survival Proportion\", \n         main = \"Yellowtail Rockfish\")\n\n```\n\n### Simple Plot of Survived/Died with Logistic Regression Analysis\n#### lose resolution for days survived\n\n```{r}\n  # \nall.mort <- rbind(copper.mort, quillback.mort, black.mort, yellowtail.mort)\nstr(all.mort)\nall.mort$Species <- as.factor(as.character(all.mort$Species))\nlog.mod.all <- glm(Status~Treatment_Temperature+Species+Treatment_Temperature*Species, family = binomial(link = 'logit'), \n                      data = all.mort)\nsummary(log.mod.all)\ntail(all.mort)\n# perfect or quasi perfect separation\n\n  # Logistic Regression\n    log.mod.cp <- glm(Status~Treatment_Temperature, family = binomial(link = 'logit'), \n                      data = copper.mort)\n    log.mod.quill <- glm(Status~Treatment_Temperature, family = binomial(link = 'logit'), \n                         data = quillback.mort)\n    log.mod.blk <- glm(Status~Treatment_Temperature, family = binomial(link = 'logit'), \n                        data = black.mort)\n    log.mod.ytl <-  glm(Status~Treatment_Temperature, family = binomial(link = 'logit'), \n                        data = yellowtail.mort)\n    \n# Summary of Logistic Regressions\n    summary(log.mod.cp)\n    summary(log.mod.quill)\n    summary(log.mod.blk)\n    summary(log.mod.ytl)\n\n  # Plot Lived/Died and Analyze\n    par(mfrow = c(2,2))\n    \n  # Copper\n    plot(copper.mort$Status~copper.mort$Treatment_Temperature, col = \"orange\", \n         pch = 19, bty = \"l\", xlab = \"Temperature Treatment\", ylab = \"Lived/Died\", \n         main = \"Copper Rockfish\")\n    \n    cop.pred <- predict(log.mod.cp, data.frame(Treatment_Temperature = 10:23), se.fit = TRUE)\n    #curve(cop.pred$fit, type = \"response\", add = TRUE, col = \"black\", lwd = 1)\n    points(y=exp(cop.pred$fit)/(1+exp(cop.pred$fit)), x = 10:23, type = \"l\")\n    points(y = exp(cop.pred$fit+1.96*cop.pred$se.fit)/(1+exp(cop.pred$fit+1.96*cop.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n    points(y = exp(cop.pred$fit-1.96*cop.pred$se.fit)/(1+exp(cop.pred$fit-1.96*cop.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n    # Add Effect Size and Signifiance to Graph \n    text(13, 0.4, labels = \"-0.48 +/- 0.2 *\")\n    \n  # Quillback\n    plot(quillback.mort$Status~quillback.mort$Treatment_Temperature, col = \"brown\", \n         pch = 19, bty = \"l\", xlab = \"Temperature Treatment\", ylab = \"Lived/Died\", \n         main = \"Quillback Rockfish\")\n    curve(predict(log.mod.quill, data.frame(Treatment_Temperature = x), type = \"response\"), \n           add = TRUE, col = \"black\", lwd = 1)\n    # Add Effect Size and Signifiance to Graph \n    text(20, 0.4, labels = \"-0.22 +/- 0.13 .\")\n      \n  # Black\n    plot(black.mort$Status~black.mort$Treatment_Temperature, col = \"black\", \n         pch = 19, bty = \"l\", xlab = \"Temperature Treatment\", ylab = \"Lived/Died\", \n         main = \"Black Rockfish\")\n    curve(predict(log.mod.blk, data.frame(Treatment_Temperature = x), type = \"response\"), \n           add = TRUE, col = \"black\", lwd = 1)\n    # Add Effect Size and Signifiance to Graph \n    text(13, 0.4, labels = \"-1.64 +/- 0.90 .\")\n    \n    # Yellowtail\n    plot(yellowtail.mort$Status~yellowtail.mort$Treatment_Temperature, col = \"goldenrod\", \n         pch = 19, bty = \"l\", xlab = \"Temperature Treatment\", ylab = \"Lived/Died\", \n         main = \"Yellowtail Rockfish\")\n    curve(predict(log.mod.ytl, data.frame(Treatment_Temperature = x), type = \"response\"), \n           add = TRUE, col = \"black\", lwd = 1)\n\n```\n\n## Proportion of total time survived across two weeks\n\n```{r}\n\n# calculate days dead \n  all.mort$PropDaysDead <- 14-all.mort$Days_Survived\n  log.mod.all.prop2 <- glm(cbind(Days_Survived, PropDaysDead)~Treatment_Temperature*Species, \n                            family = binomial(link = 'logit'), data = all.mort)\n\n  log.mod.all.prop <- glm(cbind(Days_Survived, PropDaysDead)~Treatment_Temperature+Species, \n                            family = binomial(link = 'logit'), data = all.mort)\n  summary(log.mod.all.prop2)\n  summary(aov(log.mod.all.prop))\n  \n        \n```  \n\n### Plot as four panel plot\n\n```{r}\n  par(mfrow = c(2,2))\n  par(oma = c(4, 4, 0, 0))\n  par(mar = c(2, 2, 1, 1))\n  \n## Black Rockfish ##\n  # Logistic Regression Model # \n  log.mod.black.prop <- glm(cbind(all.mort$Days_Survived[all.mort$Species==\"Black\"],\n                                   all.mort$PropDaysDead[all.mort$Species==\"Black\"])\n                              ~Treatment_Temperature, family = binomial(link = 'logit'), \n                              data = all.mort[all.mort$Species==\"Black\",])\n  summary(log.mod.black.prop)\n  \n  \n  # Plot \n  plot(all.mort$PropDaysSurv[all.mort$Species==\"Black\"]~Treatment_Temperature, \n       data = all.mort[all.mort$Species==\"Black\",], pch = 19, col = \"black\",\n       xlab = \"\", ylab = \"\", bty = \"l\", xlim = c(10,23), ylim = c(0,1), xaxt = \"n\")\n  \n  # Create Prediction for Fitting Data and Standard Error\n  blk.prop.daysurv.pred <- predict(log.mod.black.prop, \n                                   data.frame(Treatment_Temperature = 10:23), \n                                   se.fit = TRUE)\n  points(y=exp(blk.prop.daysurv.pred$fit)/(1+exp(blk.prop.daysurv.pred$fit)), x = 10:23, type = \"l\")\n  points(y = exp(blk.prop.daysurv.pred$fit+1.96*blk.prop.daysurv.pred$se.fit)/\n           (1+exp(blk.prop.daysurv.pred$fit+1.96*blk.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"darkgrey\")\n  points(y = exp(blk.prop.daysurv.pred$fit-1.96*blk.prop.daysurv.pred$se.fit)/\n             (1+exp(blk.prop.daysurv.pred$fit-1.96*blk.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"darkgrey\")\n  text(13, 0.1, label = \"-1.18 +/- 0.3***\")\n  \n## Copper Rockfish ##  \n  # Logistic Regression Model\n  log.mod.copper.prop <- glm(cbind(all.mort$Days_Survived[all.mort$Species==\"Copper\"],\n                                   all.mort$PropDaysDead[all.mort$Species==\"Copper\"])\n                              ~Treatment_Temperature, family = binomial(link = 'logit'), \n                              data = all.mort[all.mort$Species==\"Copper\",])\n  summary(log.mod.copper.prop)\n\n# Plot \n  plot(all.mort$PropDaysSurv[all.mort$Species==\"Copper\"]~Treatment_Temperature, \n       data = all.mort[all.mort$Species==\"Copper\",], pch = 19, col = \"orange\",\n       xlab = \"\", ylab = \"\", bty = \"l\", yaxt = \"n\", xaxt = \"n\", ylim = c(0,1), xlim = c(10,23))\n\n# Create Prediction for Fitting Data and Standard Error\n  cop.prop.daysurv.pred <- predict(log.mod.copper.prop, \n                                   data.frame(Treatment_Temperature = 10:23), \n                                   se.fit = TRUE)\n  points(y=exp(cop.prop.daysurv.pred$fit)/(1+exp(cop.prop.daysurv.pred$fit)), x = 10:23)\n  points(y = exp(cop.prop.daysurv.pred$fit+1.96*cop.prop.daysurv.pred$se.fit)/\n           (1+exp(cop.prop.daysurv.pred$fit+1.96*cop.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  points(y = exp(cop.prop.daysurv.pred$fit-1.96*cop.prop.daysurv.pred$se.fit)/\n             (1+exp(cop.prop.daysurv.pred$fit-1.96*cop.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  text(13, 0.1, label = \"-0.27 +/- 0.06***\")\n  \n## Yellowtail Rockfish ##  \n  # Logistic Regression Model\n  log.mod.ytl.prop <- glm(cbind(all.mort$Days_Survived[all.mort$Species==\"Yellowtail\"],\n                                   all.mort$PropDaysDead[all.mort$Species==\"Yellowtail\"])\n                              ~Treatment_Temperature, family = binomial(link = 'logit'), \n                              data = all.mort[all.mort$Species==\"Yellowtail\",])\n  summary(log.mod.ytl.prop)\n\n# Plot \n  plot(all.mort$PropDaysSurv[all.mort$Species==\"Yellowtail\"]~Treatment_Temperature, \n       data = all.mort[all.mort$Species==\"Yellowtail\",], pch = 19, col = \"goldenrod\",\n       xlab = \"\", ylab = \"\", bty = \"l\", ylim = c(0,1), xlim = c(10,23))\n\n# Create Prediction for Fitting Data and Standard Error\n  ytl.prop.daysurv.pred <- predict(log.mod.ytl.prop, \n                                   data.frame(Treatment_Temperature = 10:23), \n                                   se.fit = TRUE)\n  text(13, 0.1, label = \"ns\")\n  \n  ## sample size too low to calculate this\n  #points(y=exp(ytl.prop.daysurv.pred$fit)/(1+exp(ytl.prop.daysurv.pred$fit)), x = 10:23, type = \"l\")\n  #points(y = exp(ytl.prop.daysurv.pred$fit+1.96*ytl.prop.daysurv.pred$se.fit)/\n           #(1+exp(ytl.prop.daysurv.pred$fit+1.96*ytl.prop.daysurv.pred$se.fit)), \n           #x = 10:23, type = \"l\", col = \"lightgrey\")\n  #points(y = exp(ytl.prop.daysurv.pred$fit-1.96*ytl.prop.daysurv.pred$se.fit)/\n             #(1+exp(ytl.prop.daysurv.pred$fit-1.96*ytl.prop.daysurv.pred$se.fit)), \n           #x = 10:23, type = \"l\", col = \"lightgrey\")\n  \n## Quillback Rockfish ##  \n  # Logistic Regression Model  \n  log.mod.quill.prop <- glm(cbind(all.mort$Days_Survived[all.mort$Species==\"Quillback\"],\n                                  all.mort$PropDaysDead[all.mort$Species==\"Quillback\"])\n                              ~Treatment_Temperature, family = binomial(link = 'logit'), \n                              data = all.mort[all.mort$Species==\"Quillback\",])\n  summary(log.mod.quill.prop)\n\n  # Plot\n  plot(all.mort$PropDaysSurv[all.mort$Species==\"Quillback\"]~Treatment_Temperature, \n       data = all.mort[all.mort$Species==\"Quillback\",], pch = 19, col = \"brown\",\n       xlab = \"Temperature\", ylab = \"Proportion of Days Survived\", bty = \"l\",\n       yaxt = \"n\", ylim = c(0,1), xlim = c(10,23))\n  \n  # Create Prediction for Fitting Data and Standard Error\n  quill.prop.daysurv.pred <- predict(log.mod.quill.prop, \n                                   data.frame(Treatment_Temperature = 10:23), \n                                   se.fit = TRUE)\n  points(y=exp(quill.prop.daysurv.pred$fit)/(1+exp(quill.prop.daysurv.pred$fit)), x = 10:23, type = \"l\")\n  points(y = exp(quill.prop.daysurv.pred$fit+1.96*quill.prop.daysurv.pred$se.fit)/\n           (1+exp(quill.prop.daysurv.pred$fit+1.96*quill.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  points(y = exp(quill.prop.daysurv.pred$fit-1.96*quill.prop.daysurv.pred$se.fit)/\n             (1+exp(quill.prop.daysurv.pred$fit-1.96*quill.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  text(13, 0.1, label = \"-0.18 +/- 0.04***\")\n  \n# Add Axes Titles\n  mtext(\"Temperature\", side = 1, outer = TRUE, cex = 1, line = 2.2)\n  mtext(\"Proportion of Days Survived\", side = 2, outer = TRUE, cex = 1, line = 2.2)\n\n```\n \n### Plot with Black and Yellowtail together on same plot\n\n```{r}\n  dev.off()\n  par(mfrow = c(2,2))\n  par(oma = c(4, 4, 0, 0))\n  par(mar = c(2, 2, 1, 1))\n  \n## Copper Rockfish ##\n  plot(all.mort$PropDaysSurv[all.mort$Species==\"Copper\"]~Treatment_Temperature, \n       data = all.mort[all.mort$Species==\"Copper\",], pch = 19, col = \"orange\",\n       xlab = \"\", ylab = \"\", bty = \"l\", xaxt = \"n\", ylim = c(0,1), xlim = c(10,23))\n\n# Create Prediction for Fitting Data and Standard Error\n  cop.prop.daysurv.pred <- predict(log.mod.copper.prop, \n                                   data.frame(Treatment_Temperature = 10:23), \n                                   se.fit = TRUE)\n  points(y=exp(cop.prop.daysurv.pred$fit)/(1+exp(cop.prop.daysurv.pred$fit)), x = 10:23,\n         type = \"l\")\n  points(y = exp(cop.prop.daysurv.pred$fit+1.96*cop.prop.daysurv.pred$se.fit)/\n           (1+exp(cop.prop.daysurv.pred$fit+1.96*cop.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  points(y = exp(cop.prop.daysurv.pred$fit-1.96*cop.prop.daysurv.pred$se.fit)/\n             (1+exp(cop.prop.daysurv.pred$fit-1.96*cop.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  text(14, 0.1, label = \"slope = -0.27 +/- 0.06\")\n  text(14, 0.03, label = \"p < 0.001***\")\n  legend(19.5, 0.15, legend = \"Copper\", pch = 19, col = \"orange\", cex = 0.8)\n\n## Black and Yellowtail ##  \n # Logistic Regression Model # \n  log.mod.blkyt.prop <- glm(cbind(all.mort$Days_Survived[all.mort$Species==\"Black\" \n                                                         | all.mort$Species==\"Yellowtail\"],\n                                   all.mort$PropDaysDead[all.mort$Species==\"Black\" \n                                                         | all.mort$Species==\"Yellowtail\"])\n                              ~Treatment_Temperature, family = binomial(link = 'logit'), \n                              data = all.mort[all.mort$Species==\"Black\" \n                                              | all.mort$Species==\"Yellowtail\",])\n  summary(log.mod.blkyt.prop)\n\n # Plot\n  plot(all.mort$PropDaysSurv[all.mort$Species==\"Black\"]~Treatment_Temperature, \n       data = all.mort[all.mort$Species==\"Black\",], pch = 19, col = \"black\",\n       xlab = \"\", ylab = \"\", bty = \"l\", yaxt = \"n\", xlim = c(10,23), ylim = c(0,1))\n  points(all.mort$PropDaysSurv[all.mort$Species==\"Yellowtail\"]~Treatment_Temperature, \n       data = all.mort[all.mort$Species==\"Yellowtail\",], pch = 21, \n       bg = \"goldenrod\", col = \"black\")\n  \n # Create Prediction for Fitting Data and Standard Error\n  blkyt.prop.daysurv.pred <- predict(log.mod.blkyt.prop, \n                                   data.frame(Treatment_Temperature = 10:23), \n                                   se.fit = TRUE)\n  points(y=exp(blkyt.prop.daysurv.pred$fit)/(1+exp(blkyt.prop.daysurv.pred$fit)), \n         x = 10:23, type = \"l\")\n  points(y = exp(blkyt.prop.daysurv.pred$fit+1.96*blkyt.prop.daysurv.pred$se.fit)/\n           (1+exp(blkyt.prop.daysurv.pred$fit+1.96*blkyt.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"darkgrey\")\n  points(y = exp(blkyt.prop.daysurv.pred$fit-1.96*blkyt.prop.daysurv.pred$se.fit)/\n             (1+exp(blkyt.prop.daysurv.pred$fit-1.96*blkyt.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"darkgrey\")\n  text(14, 0.1, label = \"slope = -1.22 +/- 0.29\")\n  text(14, 0.03, label = \"p < 0.001***\")\n  legend(19.5, 0.2, legend = c(\"Black\", \"Yellowtail\"), pch = c(19, 21), \n         pt.bg = c(\"black\", \"goldenrod\"), col = c(\"black\", \"black\"), \n         cex = 0.8)\n  \n## Quillback Rockfish ##\n  plot(all.mort$PropDaysSurv[all.mort$Species==\"Quillback\"]~Treatment_Temperature, \n       data = all.mort[all.mort$Species==\"Quillback\",], pch = 19, col = \"brown\",\n       xlab = \"Temperature\", ylab = \"Proportion of Days Survived\", bty = \"l\", ylim = c(0,1), xlim = c(10,23))\n  \n  # Create Prediction for Fitting Data and Standard Error\n  quill.prop.daysurv.pred <- predict(log.mod.quill.prop, \n                                   data.frame(Treatment_Temperature = 10:23), \n                                   se.fit = TRUE)\n  points(y=exp(quill.prop.daysurv.pred$fit)/(1+exp(quill.prop.daysurv.pred$fit)), x = 10:23, type = \"l\")\n  points(y = exp(quill.prop.daysurv.pred$fit+1.96*quill.prop.daysurv.pred$se.fit)/\n           (1+exp(quill.prop.daysurv.pred$fit+1.96*quill.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  points(y = exp(quill.prop.daysurv.pred$fit-1.96*quill.prop.daysurv.pred$se.fit)/\n             (1+exp(quill.prop.daysurv.pred$fit-1.96*quill.prop.daysurv.pred$se.fit)), \n           x = 10:23, type = \"l\", col = \"lightgrey\")\n  text(14, 0.1, label = \"slope = -0.18 +/- 0.04\")\n  text(14, 0.03, label = \"p < 0.001***\")\n  legend(19.5, 0.15, legend = \"Quillback\", pch = 19, col = \"brown\", cex = 0.8)\n\n  mtext(\"Temperature\", side = 1, outer = TRUE, cex = 1, line = 2.2)\n  mtext(\"Proportion of Days Survived\", side = 2, outer = TRUE, cex = 1, line = 2.2)\n```\n \n```{r}\n# confidence intervals bar plot\n# Black rockfish\nblk.fit <- as.data.frame(exp(blk.prop.daysurv.pred$fit)/(1+exp(blk.prop.daysurv.pred$fit)))\nblk.up.CI <- as.data.frame(exp(blk.prop.daysurv.pred$fit+1.96*blk.prop.daysurv.pred$se.fit)/\n           (1+exp(blk.prop.daysurv.pred$fit+1.96*blk.prop.daysurv.pred$se.fit)))\nblk.low.CI <- as.data.frame(exp(blk.prop.daysurv.pred$fit-1.96*blk.prop.daysurv.pred$se.fit)/\n             (1+exp(blk.prop.daysurv.pred$fit-1.96*blk.prop.daysurv.pred$se.fit)))\nblk.logistic.data <- cbind(blk.fit, blk.up.CI, blk.low.CI)\ncolnames(blk.logistic.data) <- c(\"blk.log.fit\", \"blk.up.CI\", \"blk.low.CI\")\n\n# Copper rockfish\ncp.fit <- as.data.frame(exp(cop.prop.daysurv.pred$fit)/(1+exp(cop.prop.daysurv.pred$fit)))\ncp.up.CI <- as.data.frame(exp(cop.prop.daysurv.pred$fit+1.96*cop.prop.daysurv.pred$se.fit)/\n           (1+exp(cop.prop.daysurv.pred$fit+1.96*cop.prop.daysurv.pred$se.fit))) \ncp.low.CI <- as.data.frame(exp(cop.prop.daysurv.pred$fit-1.96*cop.prop.daysurv.pred$se.fit)/\n             (1+exp(cop.prop.daysurv.pred$fit-1.96*cop.prop.daysurv.pred$se.fit)))\ncp.logistic.data <- cbind(cp.fit, cp.up.CI, cp.low.CI)\ncolnames(cp.logistic.data) <- c(\"cp.log.fit\", \"cp.up.CI\", \"cp.low.CI\")\n\n# Quillback rockfish\nqb.fit <- as.data.frame(exp(quill.prop.daysurv.pred$fit)/(1+exp(quill.prop.daysurv.pred$fit)))\nqb.up.CI <- as.data.frame(exp(quill.prop.daysurv.pred$fit+1.96*quill.prop.daysurv.pred$se.fit)/\n           (1+exp(quill.prop.daysurv.pred$fit+1.96*quill.prop.daysurv.pred$se.fit)))\nqb.low.CI <- as.data.frame(exp(quill.prop.daysurv.pred$fit-1.96*quill.prop.daysurv.pred$se.fit)/\n             (1+exp(quill.prop.daysurv.pred$fit-1.96*quill.prop.daysurv.pred$se.fit)))\nqb.logistic.data <- cbind(qb.fit, qb.up.CI, qb.low.CI)\ncolnames(qb.logistic.data) <- c(\"qb.log.fit\", \"qb.up.CI\", \"qb.low.CI\")\n\n\n# confidence intervals bar plot\n# Black & Yellowtail rockfish\nblkyt.fit <- as.data.frame(exp(blkyt.prop.daysurv.pred$fit)/(1+exp(blkyt.prop.daysurv.pred$fit)))\nblkyt.up.CI <- as.data.frame(exp(blkyt.prop.daysurv.pred$fit+1.96*blkyt.prop.daysurv.pred$se.fit)/\n           (1+exp(blkyt.prop.daysurv.pred$fit+1.96*blkyt.prop.daysurv.pred$se.fit)))\nblkyt.low.CI <- as.data.frame(exp(blkyt.prop.daysurv.pred$fit-1.96*blkyt.prop.daysurv.pred$se.fit)/\n             (1+exp(blkyt.prop.daysurv.pred$fit-1.96*blkyt.prop.daysurv.pred$se.fit)))\nblkyt.logistic.data <- cbind(blkyt.fit, blkyt.up.CI, blkyt.low.CI)\ncolnames(blkyt.logistic.data) <- c(\"blkyt.log.fit\", \"blkyt.up.CI\", \"blkyt.low.CI\")\nlogistic.CI.data <- cbind(blk.logistic.data, cp.logistic.data, \n                          qb.logistic.data, blkyt.logistic.data)\nrownames(logistic.CI.data) <- c(10:23)\n\n# Create Data Frame for Bar Graph\n  #bkfit <- cbind(logistic.CI.data$blk.log.fit[c(5,11,13)])\n  cpfit <- cbind(logistic.CI.data$cp.log.fit[c(5,11,13)])\n  qbfit <- cbind(logistic.CI.data$qb.log.fit[c(5,11,13)])\n  blkytfit <- cbind(logistic.CI.data$blkyt.log.fit[c(5,11,13)])\n  log.fits <- t(cbind(blkytfit, cpfit, qbfit))\n  \n# Create Data Frame for upper CI\n  #blkup <- cbind(logistic.CI.data$blk.up.CI[c(5,11,13)])\n  cpup <- cbind(logistic.CI.data$cp.up.CI[c(5,11,13)])\n  qbup <- cbind(logistic.CI.data$qb.up.CI[c(5,11,13)])\n  blkytup <- cbind(logistic.CI.data$blkyt.up.CI[c(5,11,13)])\n  up.CI <- t(cbind(blkytup, cpup, qbup))\n\n# Create Data Frame for lower CI  \n  #blklow <- cbind(logistic.CI.data$blk.low.CI[c(5,11,13)])\n  cplow <- cbind(logistic.CI.data$cp.low.CI[c(5,11,13)])\n  qblow <- cbind(logistic.CI.data$qb.low.CI[c(5,11,13)])\n  blkytlow <- cbind(logistic.CI.data$blkyt.low.CI[c(5,11,13)])\n  low.CI <- t(cbind(blkytlow, cplow, qblow))\n  \n# Create barplot of \n  par(lwd = 2)\nbp <- barplot(log.fits, beside = T, names = c(\"14°C\", \"20°C\", \"22°C\"), \n              col = c(\"black\",\"orange\", \"brown\"), border = c(\"goldenrod\", NA, NA),\n              ylim = c(0,1.12), ylab = \"Proportion of Days Survived\")\npar(lwd = 1)\nlegend(\"topright\", legend = c(\"Black & Yellowtail\", \"Copper\", \"Quillback\"), fill = c(\"black\", \"orange\", \"brown\"), border = c(\"goldenrod\", NA, NA),\n       cex = 0.55)\narrows(x0 = bp, x1 = bp, y0 = low.CI, y1 = up.CI, angle = 90, len = 0.1, code = 3, xpd = NA, \n       col = \"darkgrey\")\n```\n\n### Plankton counts for feeding\n\n```{r}\n\nplanktonPERfish.blk <- c(1700.37, 1156.06, 895.00, 1083.91, 1295.62, 981.04, 1138.08, 893.83, 1405.71, 1074.82, 1835.25, 1315.98, 1912.35, 1332.2, 1274.1, 1621.9, 1941.9, 1306.11, 696.6, 986.20, 1103.61, 652.86, 924.6, 768.24, 905.58)\nplanktonPERfish.cp <- c(1153.40, 846.15, 961.74, 1059.8, 1097.1, 675.90, 1241.65, 694.50, 746.67, 1102, 841.33, 705.50, 976.5, 1075.49, 1153.33, 1085.96, 1148.56, 1067.54, 1063.95, 1076.95, 1068.75, 1086.00, 1112.04, 1122.00, 1115.0, 1129.33, 1265.33, 1105.00, 1160.4, 1117.44, 1159)\n\nmean(planktonPERfish.blk)\nmean(planktonPERfish.cp)\nsd(planktonPERfish.blk)\nsd(planktonPERfish.cp)\n```\n\n\n### Make sure that nothing significant happens at day ten in terms of mortality\n\n```{r}\n# Subset Data for Greater than 18C Treatments\ncp.18 <- all.mort[all.mort$Species == \"Copper\" & all.mort$Treatment_Temperature > 18,]\nblk.18 <- all.mort[all.mort$Species == \"Black\" & all.mort$Treatment_Temperature > 18,]\nylt.18 <- all.mort[all.mort$Species == \"Yellowtail\" & all.mort$Treatment_Temperature > 18,]\nqb.18 <- all.mort[all.mort$Species == \"Quillback\" & all.mort$Treatment_Temperature > 18,]\n\n# Subset Data for Less than 18C Treatments\ncp.less18 <- all.mort[all.mort$Species == \"Copper\" & all.mort$Treatment_Temperature < 18,]\nblk.less18 <- all.mort[all.mort$Species == \"Black\" & all.mort$Treatment_Temperature < 18,]\nylt.less18 <- all.mort[all.mort$Species == \"Yellowtail\" & all.mort$Treatment_Temperature < 18,]\nqb.less18 <- all.mort[all.mort$Species == \"Quillback\" & all.mort$Treatment_Temperature < 18,]\n\n# Subset Data for Less than 15.5C Treatments\ncp.less15 <- all.mort[all.mort$Species == \"Copper\" & all.mort$Treatment_Temperature < 15,]\nblk.less15 <- all.mort[all.mort$Species == \"Black\" & all.mort$Treatment_Temperature < 15,]\nylt.less15 <- all.mort[all.mort$Species == \"Yellowtail\" & all.mort$Treatment_Temperature < 15,]\nqb.less15 <- all.mort[all.mort$Species == \"Quillback\" & all.mort$Treatment_Temperature < 15,]\n\n## Black 18 ##\nperc_mort_blk18 <- matrix(NA, 14, 3)\ncolnames(perc_mort_blk18) <- c(\"blkG18\", \"blkL18\", \"blkL15\")\nsurvDayG18 <- NULL\nsurvDayL18 <- NULL\nsurvDayL15 <- NULL\nfor (i in 1:14){\n  if(i == 1){\n    # Greater than 18\n      survDayG18 <- length(blk.18$Days_Survived)\n      perc_mort_blk18[i,1] <- length(blk.18$Days_Survived)/length(blk.18$Days_Survived)\n    # Less than 18\n      survDayL18 <- length(blk.less18$Days_Survived)\n      perc_mort_blk18[i,2] <- length(blk.less18$Days_Survived)/length(blk.less18$Days_Survived)\n    # Less than 15\n      survDayL15 <- length(blk.less15$Days_Survived)\n      perc_mort_blk18[i,3] <- length(blk.less15$Days_Survived)/length(blk.less15$Days_Survived)\n  } else if (i == 14){\n    # Greater than 18\n      survDayG18 <- c(survDayG18, length(blk.18$Days_Survived[blk.18$Days_Survived == i]))\n      perc_mort_blk18[i,1] <- survDayG18[i]/length(blk.18$Days_Survived)\n    # Less than 18\n      survDayL18 <- c(survDayL18, length(blk.less18$Days_Survived[blk.less18$Days_Survived == i]))\n      perc_mort_blk18[i,2] <- survDayL18[i]/length(blk.less18$Days_Survived)\n    # Less than 15\n      survDayL15 <- c(survDayL15, length(blk.less15$Days_Survived[blk.less15$Days_Survived == i]))\n      perc_mort_blk18[i,3] <- survDayL15[i]/length(blk.less15$Days_Survived)\n  } else {\n    # Greater than 18\n      survDayG18 <- c(survDayG18, (survDayG18[i-1] - \n                                     length(blk.18$Days_Survived[blk.18$Days_Survived == i])))\n      perc_mort_blk18[i,1] <- survDayG18[i]/length(blk.18$Days_Survived)\n    # Less than 18\n      survDayL18 <- c(survDayL18, (survDayL18[i-1] - \n                                     length(blk.less18$Days_Survived[blk.less18$Days_Survived == i])))\n      perc_mort_blk18[i,2] <- survDayL18[i]/length(blk.less18$Days_Survived)\n    # Less than 15\n      survDayL15 <- c(survDayL15, (survDayL15[i-1] - \n                                     length(blk.less15$Days_Survived[blk.less15$Days_Survived == i])))\n      perc_mort_blk18[i,3] <- survDayL15[i]/length(blk.less15$Days_Survived)\n  }\n}\n\n## Copper 18 ##\nperc_mort_cp18 <- matrix(NA, 14, 3)\ncolnames(perc_mort_cp18) <- c(\"cpG18\", \"cpL18\", \"cpL15\")\nsurvDayG18 <- NULL\nsurvDayL18 <- NULL\nsurvDayL15 <- NULL\nfor (i in 1:14){\n  if(i == 1){\n    # Greater than 18\n      survDayG18 <- length(cp.18$Days_Survived)\n      perc_mort_cp18[i,1] <- length(cp.18$Days_Survived)/length(cp.18$Days_Survived)\n    # Less than 18\n      survDayL18 <- length(cp.less18$Days_Survived)\n      perc_mort_cp18[i,2] <- length(cp.less18$Days_Survived)/length(cp.less18$Days_Survived)\n    # Less than 15\n      survDayL15 <- length(cp.less15$Days_Survived)\n      perc_mort_cp18[i,3] <- length(cp.less15$Days_Survived)/length(cp.less15$Days_Survived)\n  } else if (i == 14){\n    # Greater than 18\n      survDayG18 <- c(survDayG18, length(cp.18$Days_Survived[cp.18$Days_Survived == i]))\n      perc_mort_cp18[i,1] <- survDayG18[i]/length(cp.18$Days_Survived)\n    # Less than 18\n      survDayL18 <- c(survDayL18, length(cp.less18$Days_Survived[cp.less18$Days_Survived == i]))\n      perc_mort_cp18[i,2] <- survDayL18[i]/length(cp.less18$Days_Survived)\n    # Less than 15\n      survDayL15 <- c(survDayL15, length(cp.less15$Days_Survived[cp.less15$Days_Survived == i]))\n      perc_mort_cp18[i,3] <- survDayL15[i]/length(cp.less15$Days_Survived)\n  } else {\n    # Greater than 18\n      survDayG18 <- c(survDayG18, (survDayG18[i-1] - \n                                     length(cp.18$Days_Survived[cp.18$Days_Survived == i])))\n      perc_mort_cp18[i,1] <- survDayG18[i]/length(cp.18$Days_Survived)\n    # Less than 18\n      survDayL18 <- c(survDayL18, (survDayL18[i-1] - \n                                     length(cp.less18$Days_Survived[cp.less18$Days_Survived == i])))\n      perc_mort_cp18[i,2] <- survDayL18[i]/length(cp.less18$Days_Survived)\n    # Less than 15\n      survDayL15 <- c(survDayL15, (survDayL15[i-1] - \n                                     length(cp.less15$Days_Survived[cp.less15$Days_Survived == i])))\n      perc_mort_cp18[i,3] <- survDayL15[i]/length(cp.less15$Days_Survived)\n  }\n}\n\n## Quillback 18 ##\nperc_mort_qb18 <- matrix(NA, 14, 3)\ncolnames(perc_mort_qb18) <- c(\"qbG18\", \"qbL18\", \"qbL15\")\nsurvDayG18 <- NULL\nsurvDayL18 <- NULL\nsurvDayL15 <- NULL\nfor (i in 1:14){\n  if(i == 1){\n    # Greater than 18\n      survDayG18 <- length(qb.18$Days_Survived)\n      perc_mort_qb18[i,1] <- length(qb.18$Days_Survived)/length(qb.18$Days_Survived)\n    # Less than 18\n      survDayL18 <- length(qb.less18$Days_Survived)\n      perc_mort_qb18[i,2] <- length(qb.less18$Days_Survived)/length(qb.less18$Days_Survived)\n    # Less than 15\n      survDayL15 <- length(qb.less15$Days_Survived)\n      perc_mort_qb18[i,3] <- length(qb.less15$Days_Survived)/length(qb.less15$Days_Survived)\n  } else if (i == 14){\n    # Greater than 18\n      survDayG18 <- c(survDayG18, length(qb.18$Days_Survived[qb.18$Days_Survived == i]))\n      perc_mort_qb18[i,1] <- survDayG18[i]/length(qb.18$Days_Survived)\n    # Less than 18\n      survDayL18 <- c(survDayL18, length(qb.less18$Days_Survived[qb.less18$Days_Survived == i]))\n      perc_mort_qb18[i,2] <-  survDayL18[i]/length(qb.less18$Days_Survived)\n    # Less than 15\n      survDayL15 <- c(survDayL15, length(qb.less15$Days_Survived[qb.less15$Days_Survived == i]))\n      perc_mort_qb18[i,3] <-  survDayL15[i]/length(qb.less15$Days_Survived)\n  } else {\n    # Greater than 18\n      survDayG18 <- c(survDayG18, (survDayG18[i-1] - \n                                     length(qb.18$Days_Survived[qb.18$Days_Survived == i])))\n      perc_mort_qb18[i,1] <- survDayG18[i]/length(qb.18$Days_Survived)\n    # Less than 18\n      survDayL18 <- c(survDayL18, (survDayL18[i-1] - \n                                     length(qb.less18$Days_Survived[qb.less18$Days_Survived == i])))\n      perc_mort_qb18[i,2] <- survDayL18[i]/length(qb.less18$Days_Survived)\n    # Less than 15\n      survDayL15 <- c(survDayL15, (survDayL15[i-1] - \n                                     length(qb.less15$Days_Survived[qb.less15$Days_Survived == i])))\n      perc_mort_qb18[i,3] <- survDayL15[i]/length(qb.less15$Days_Survived)\n  }\n}\n\n## Yellowtail 18 ##\nperc_mort_ylt18 <- matrix(NA, 14, 3)\ncolnames(perc_mort_ylt18) <- c(\"yltG18\", \"yltL18\", \"yltL15\")\nsurvDayG18 <- NULL\nsurvDayL18 <- NULL\nsurvDayL15 <- NULL\nfor (i in 1:14){\n  if(i == 1){\n    # Greater than 18\n      survDayG18 <- length(ylt.18$Days_Survived)\n      perc_mort_ylt18[i,1] <- length(ylt.18$Days_Survived)/length(ylt.18$Days_Survived)\n    # Less than 18\n      survDayL18 <- length(ylt.less18$Days_Survived)\n      perc_mort_ylt18[i,2] <- length(ylt.less18$Days_Survived)/length(ylt.less18$Days_Survived)\n    # Less than 15\n      survDayL15 <- length(ylt.less15$Days_Survived)\n      perc_mort_ylt18[i,3] <- length(ylt.less15$Days_Survived)/length(ylt.less15$Days_Survived)\n  } else if (i == 14){\n    # Greater than 18\n      survDayG18 <- c(survDayG18, length(ylt.18$Days_Survived[ylt.18$Days_Survived == i]))\n      perc_mort_ylt18[i,1] <- survDayG18[i]/length(ylt.18$Days_Survived)\n    # Less than 18\n      survDayL18 <- c(survDayL18, length(ylt.less18$Days_Survived[ylt.less18$Days_Survived == i]))\n      perc_mort_ylt18[i,2] <-  survDayL18[i]/length(ylt.less18$Days_Survived)\n    # Less than 15\n      survDayL15 <- c(survDayL15, length(ylt.less15$Days_Survived[ylt.less15$Days_Survived == i]))\n      perc_mort_ylt18[i,3] <-  survDayL15[i]/length(ylt.less15$Days_Survived)\n  } else {\n    # Greater than 18\n      survDayG18 <- c(survDayG18, (survDayG18[i-1] - \n                                     length(ylt.18$Days_Survived[ylt.18$Days_Survived == i])))\n      perc_mort_ylt18[i,1] <- survDayG18[i]/length(ylt.18$Days_Survived)\n    # Less than 18\n      survDayL18 <- c(survDayL18, (survDayL18[i-1] - \n                                     length(ylt.less18$Days_Survived[ylt.less18$Days_Survived == i])))\n      perc_mort_ylt18[i,2] <- survDayL18[i]/length(ylt.less18$Days_Survived)\n    # Less than 15\n      survDayL15 <- c(survDayL15, (survDayL15[i-1] - \n                                     length(ylt.less15$Days_Survived[ylt.less15$Days_Survived == i])))\n      perc_mort_ylt18[i,3] <- survDayL15[i]/length(ylt.less15$Days_Survived)\n  }\n}\n\n```\n\n\n```{r}\n\ndays <- 1:14\nall.mort.data <- cbind(days, perc_mort_blk18, perc_mort_cp18, perc_mort_qb18, perc_mort_ylt18)\npar(mfrow = c(1,2))\n # Plot Mortality in Greater than 18C Treatments for All Species\n  plot(blkG18~days, data = all.mort.data, ylim = c(0,1.1), type = \"l\", col = \"black\", lty = 2, \n       lwd = 3, ylab = \"Proportion of Fish Alive\", xlab = \"Day\", bty = \"l\", \n       main = \"Mortality in > 18C Treatments\")\n    points(cpG18~days, data = all.mort.data, type = \"l\", col = \"orange\", lwd = 3)\n    points(qbG18~days, data = all.mort.data, type = \"l\", col = \"brown\", lwd = 3)\n    lines(yltG18~days, data = all.mort.data, lty = 2, type = \"l\", col = \"goldenrod\", lwd = 3)\n    abline(v = 10, lty = 2)\n    legend(1, 0.35, legend = c(\"Copper\", \"Quillback\", \"Black\", \"Yellowtail\"), \n           col = c(\"orange\", \"brown\", \"black\", \"goldenrod\"), lwd = 3, lty = c(1, 1, 2, 2))\n    text(13, 0.61, label = \"n = 24\", col = \"orange\")\n    text(13, 0.1, label = \"n = 9\", col = \"brown\")\n    text(13, 0.8, label = \"n = 4\", col = \"goldenrod\")\n    text(13, 0.9, label = \"n = 19\", col = \"black\")\n    \n # Plot Mortality in Less than 18C Treatments for All Species\n  plot(blkL18~days, data = all.mort.data, ylim = c(0,1.1), type = \"l\", col = \"black\", lwd = 3, \n       ylab = \"Proportion of Fish Alive\", xlab = \"Day\", bty = \"l\", \n       main = \"Mortality in < 18C Treatments\")\n    points(qbL18~days, data = all.mort.data, type = \"l\", col = \"brown\", lwd = 3)\n    points(cpL18~days, data = all.mort.data, type = \"l\", col = \"orange\", lwd = 3)\n    lines(yltL18~days, data = all.mort.data, lty = 2, col = \"goldenrod\", lwd = 3)\n    abline(v = 10, lty = 2)\n    legend(1, 0.35, legend = c(\"Copper\", \"Quillback\", \"Black\",\"Yellowtail\"), \n           col = c(\"orange\", \"brown\", \"black\", \"goldenrod\"), lwd = 3, lty = c(1, 1, 2, 2))\n    text(13.6, 0.95, label = \"n = 12\", col = \"orange\")\n    text(13.6, 0.6, label = \"n = 11\", col = \"brown\")\n    text(13.4, 1.11, label = \"n = 5\", col = \"goldenrod\")\n    text(13.6, 1.04, label = \"n = 10\", col = \"black\")\n    \n  # Plot Mortality in Less than 18C Treatments for All Species\n  plot(blkL15~days, data = all.mort.data, ylim = c(0,1.1), type = \"l\", col = \"black\", lwd = 3, \n       ylab = \"Proportion of Fish Alive\", xlab = \"Day\", bty = \"l\", \n       main = \"Mortality in < 15C Treatments\")\n    points(qbL15~days, data = all.mort.data, type = \"l\", col = \"brown\", lwd = 3)\n    points(cpL15~days, data = all.mort.data, type = \"l\", col = \"orange\", lwd = 3)\n    lines(yltL15~days, data = all.mort.data, lty = 2, col = \"goldenrod\", lwd = 3)\n    abline(v = 10, lty = 2)\n    legend(1, 0.35, legend = c(\"Copper\", \"Quillback\", \"Black\",\"Yellowtail\"), \n           col = c(\"orange\", \"brown\", \"black\", \"goldenrod\"), lwd = 3, lty = c(1, 1, 2, 2))\n    text(13.6, 0.95, label = \"n = 12\", col = \"orange\")\n    text(13.6, 0.6, label = \"n = 11\", col = \"brown\")\n    text(13.4, 1.11, label = \"n = 5\", col = \"goldenrod\")\n    text(13.6, 1.04, label = \"n = 10\", col = \"black\")\n\n```\n\n\n\n",
    "created" : 1551058760525.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4047366707",
    "id" : "1D28CC89",
    "lastKnownWriteTime" : 1551059435,
    "last_content_update" : 1551059435250,
    "path" : "~/Documents/Northeastern/LotterhosLab/Research/Field Work/2015/TPC_Experiment/Analysis/scripts/Mortality_Data.Rmd",
    "project_path" : "scripts/Mortality_Data.Rmd",
    "properties" : {
        "chunk_output_type" : "console"
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}